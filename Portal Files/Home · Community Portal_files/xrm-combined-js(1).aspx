XRM.onActivate(function(){function i(t){if(!YAHOO.util.Cookie)return XRM.log("YAHOO.util.Cookie not loaded. Cannot enable Preview functionality.","warn"),null;if(n("[data-xrm-preview-permitted], .xrm-preview-permitted").length<1)return null;var i=YAHOO.util.Cookie.get("adxPreviewUnpublishedEntities",function(n){return n==="true"}),r=n("<div />").addClass("xrm-editable-toolbar-module").prependTo(t).get(0);return new YAHOO.widget.Button({container:r,type:"checkbox",label:i?window.ResourceManager.Preview_On_Label:window.ResourceManager.Preview_Off_Label,title:window.ResourceManager.Published_UnPublished_Entities_Title,onclick:{fn:function(){YAHOO.util.Cookie.set("adxPreviewUnpublishedEntities",!i,{path:"/"});location.reload()}},checked:i})}function t(n,t,i){var r;return function(){var u=this,f=arguments,e=function(){r=null;i||n.apply(u,f)},o=i&&!r;clearTimeout(r);r=setTimeout(e,t);o&&n.apply(u,f)}}var n=XRM.jQuery;n(document).ready(function(){var r,u;n(document).on("focus",".first-child",function(){n("span.yui-push-button>span.first-child button").last().on("focus",function(){n("span.yui-button.yui-menu-button button").attr("aria-expanded","false")})});n(document).on("hover",".yuimenuitem",function(){n(".yuimenuitemlabel").each(function(){n(this).parent().attr("title",n(this).text())});n(this).unbind("hover")});n(document).on("hover",".yui-button > .first-child > button",function(){n(this).attr("title",n(this).text());n(this).unbind("hover")});if(n(".container-close").click(function(){n(".yuimenu").removeClass("visible");n(".yuimenu").addClass("yui-overlay-hidden");n(".yuimenu").attr("style","z-index: 1; position: absolute; visibility: hidden;")}),!XRM.editable.toolbar){XRM.log("Unable to extend XRM.editable.toolbar.","warn");return}i(XRM.editable.toolbar.body);r=t(function(){XRM.editable.toolbar.align("tr","tr")},100);r();n(window).resize(r).scroll(r);n(XRM.editable.toolbar.element).addClass("xrm-editable-toolbar-pinned");XRM.editable.toolbar.dragEvent.subscribe(function(){u&&clearTimeout(u);n(XRM.editable.toolbar.element).removeClass("xrm-editable-toolbar-pinned");u=setTimeout(function(){n(XRM.editable.toolbar.element).addClass("xrm-editable-toolbar-pinned")},100)});n(".container-close").attr("role","button").attr("title",window.ResourceManager.Close_DefaultText)});XRM.namespace("ui").getEditTooltip=function(t){var i=n(t),r=i.data("label")||i.children(".xrm-entity-ref").attr("title");return r?XRM.localize("editable.label.prefix")+r:XRM.localize("editable.tooltip")};n.fn.extend({editable:function(i,r){function h(){u.hide();f.removeClass("xrm-editable-hover")}var e,c,l,a;r=r||{};var f=this,o=f.get(0),y=n("<div />").addClass("xrm-editable-overlay").appendTo(n("body")),v=n("<div />").addClass("xrm-editable-panel xrm-editable-controls").appendTo(y),u=new YAHOO.widget.Panel(v.get(0),{close:!1,draggable:!1,constraintoviewport:!0,visible:!1,zindex:XRM.zindex,context:[o,"tl","tl"],underlay:"none"}),s=f.data("label")||f.children(".xrm-entity-ref").attr("title");u.setBody('<a class="xrm-editable-edit"><\/a><span class="xrm-editable-label"><\/span>');u.render();s?n(".xrm-editable-label",u.body).text(s).attr("title",s):n(".xrm-editable-label",u.body).remove();n(".xrm-editable-edit",u.body).attr("title",XRM.ui.getEditTooltip(o)).text(XRM.ui.getEditLabel(o)).click(function(){if(!i){h();n.isFunction(r.loadSuccess)&&r.loadSuccess();return}var t=XRM.ui.showProgressPanelAtXY(XRM.localize("editable.loading"),YAHOO.util.Dom.getXY(o));h();XRM.data.getJSON(i,{success:function(i){t();n.isFunction(r.loadSuccess)&&r.loadSuccess(i)},error:function(i){t();n.isFunction(r.loadError)?r.loadError(i):XRM.ui.showDataServiceError(i)}})});e=t(function(){var n=o.getBoundingClientRect();n&&n.top<30?u.align("tl","bl",[0,0]):u.align("tl","tl",[0,-29])},100);e();n(window).load(e).resize(e).scroll(e);n(document).ajaxComplete(e);l=function(){c&&clearTimeout(c);f.addClass("xrm-editable-hover");u.show()};a=function(){c=setTimeout(h,100)};v.hover(l,a);f.hover(l,a)},noneditable:function(){this.off("mouseenter mouseleave")}})});XRM.onActivate(function(){function i(){return/(iPod|iPhone|iPad)/i.test(navigator.userAgent.toLowerCase())}function r(){return/android/i.test(navigator.userAgent.toLowerCase())}var t=XRM.namespace("util"),n=XRM.jQuery;n.extend(!0,XRM.localizations,{"entity.create.label":window.ResourceManager.Entity_Create_Label,"entity.create.adx_webfile.label":window.ResourceManager.Entity_Create_Adx_Webfile_Label,"entity.create.adx_webfile.tooltip":window.ResourceManager.Entity_Create_Adx_Webfile_Tooltip,"entity.create.adx_weblink.tooltip":window.ResourceManager.Entity_Create_Adx_Weblink_Tooltip,"entity.create.adx_webpage.label":window.ResourceManager.Entity_Create_Adx_Webpage_Label,"entity.create.adx_webpage.tooltip":window.ResourceManager.Entity_Create_Adx_Webpage_Tooltip,"entity.delete.adx_weblink.tooltip":window.ResourceManager.Entity_Delete_Adx_Weblink_Tooltip,"entity.update.label":window.ResourceManager.Edit_Label,"adx_webfile.shortname":window.ResourceManager.Adx_Webfile_Shortname,"adx_webfile.update.tooltip":window.ResourceManager.Adx_Webfile_Update_Tooltip,"adx_weblink.update.tooltip":window.ResourceManager.Adx_Weblink_Update_Tooltip,"adx_webpage.shortname":window.ResourceManager.Adx_Webpage_Shortname,"adx_webpage.update.tooltip":window.ResourceManager.Adx_Webpage_Update_Tooltip,"datetimepicker.datepicker.label":window.ResourceManager.Datetimepicker_Datepicker_Label,"editable.cancel.label":window.ResourceManager.Editable_Cancel_Label,"editable.delete.label":window.ResourceManager.Editable_Delete_Label,"editable.delete.tooltip.prefix":window.ResourceManager.Editable_Delete_Tooltip_Prefix,"editable.label":window.ResourceManager.Edit_Label,"editable.label.prefix":window.ResourceManager.Edit_Label_Prefix,"editable.loading":window.ResourceManager.Editable_Loading,"editable.required.label":window.ResourceManager.Editable_Required_Label,"editable.save.label":window.ResourceManager.Editable_Save_Label,"editable.saving":window.ResourceManager.Editable_Saving,"editable.sortable.tooltip":window.ResourceManager.Editable_Sortable_Tooltip,"editable.tooltip":window.ResourceManager.Editable_Tooltip,"error.dataservice.default":window.ResourceManager.Error_Dataservice_Default,"error.dataservice.loading":window.ResourceManager.Error_Dataservice_Loading,"error.dataservice.loading.field.prefix":window.ResourceManager.Error_Dataservice_Loading_Field_Prefix,"confirm.delete.entity.prefix":window.ResourceManager.Confirm_Delete_Entity_Prefix,"confirm.no":window.ResourceManager.Confirm_No,"confirm.unsavedchanges":window.ResourceManager.Confirm_Unsavedchanges,"confirm.yes":window.ResourceManager.Confirm_Yes,"validation.required.suffix":window.ResourceManager.Validation_Required_Suffix,"sitemapchildren.header.label":window.ResourceManager.Sitemapchildren_Header_Label,"sitemarker.warningmessage":window.ResourceManager.SiteMarker_WarningMessage,"sitemarkers.warningmessage":window.ResourceManager.SiteMarkers_WarningMessage,"validation.partialurl.suffix":window.ResourceManager.Validation_PartialUrl_Suffix,"validation.childpage.partialurl.notslash.message":window.ResourceManager.Validation_ChildPage_PartialUrl_NotSlash_Message,"validation.childpage.partialurl.not.unique":window.ResourceManager.Validation_ChildPage_PartialUrl_NotUnique_Message,"validation.homepage.partialurl.notslash.message":window.ResourceManager.Validation_HomePage_PartialUrl_NotSlash_Message});t.StringFormatter=function(){function n(){}return n.format=function(n){for(var t,u,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];for(t=0;t<r.length;t++)u=new RegExp("\\{"+t+"\\}","gm"),n=n.replace(u,r[t]);return n},n}();t.isAppleOrAndroid=function(){return i()||r()};t.expandUriTemplate=function(n,t){return n.replace(/{([^}]+)}/g,function(n,i){for(var f=i.split("."),e=t||{},u=null,r=0;r<f.length;r++)u=e[f[r]];return typeof u=="undefined"||u===null?"":escape(u)})};t.updateQueryStringParameter=function(n,t,i){var r=new RegExp("([?&])"+t+"=.*?(&|$)","i"),u=n.indexOf("?")!==-1?"&":"?";return n.match(r)?n.replace(r,"$1"+t+"="+i+"$2"):n+u+t+"="+i};typeof CKEDITOR!="undefined"&&(CKEDITOR.stylesSet.add("cms",[{name:window.ResourceManager.CKEditor_Code_Style,element:"code"},{name:window.ResourceManager.CKEditor_Code_Block_Style,element:"pre",attributes:{"class":"linenums prettyprint"}}]),function(){var i=n("[data-app-path]").data("app-path")||"/",t=i+"xrm-adx/js/ckeditor_plugins/";CKEDITOR.plugins.addExternal("xrmsave",t+"xrmsave/","plugin.js");CKEDITOR.plugins.addExternal("ace",t+"ace/","plugin.js");CKEDITOR.plugins.addExternal("select2",t+"select2/","plugin.js");CKEDITOR.plugins.addExternal("cmstemplate",t+"cmstemplate/","plugin.js")}());XRM.ckeditorSettings={customConfig:"",extraPlugins:"xrmsave,ace,select2,cmstemplate,contextmenu,",allowedContent:!0,entities:!1,height:400,uiColor:"#EEEEEE",stylesSet:"cms",disableNativeSpellChecker:!1,resize_dir:"both",toolbarGroups:[{name:"document",groups:["document","doctools","mode"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker","editing"]},{name:"links",groups:["links"]},{name:"insert",groups:["insert"]},{name:"forms",groups:["forms"]},{name:"tools",groups:["tools"]},"/",{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi","paragraph"]},{name:"styles",groups:["styles"]},{name:"colors",groups:["colors"]},{name:"others",groups:["others"]},{name:"about",groups:["about"]}],removeButtons:"Save,NewPage,Preview,Print,Templates,SelectAll,Form,Checkbox,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,Smiley,PageBreak,Font,FontSize,CreateDiv,BidiRtl,BidiLtr,Language,About,Subscript,Superscript,Source,Replace"};XRM.ckeditorCompactSettings=n.extend(!0,{},XRM.ckeditorSettings);XRM.ckeditorCompactSettings.height=240;XRM.ckeditorCompactSettings.resize_enabled=!1;XRM.ckeditorCompactSettings.removeButtons="XrmSave,"+XRM.ckeditorCompactSettings.removeButtons;XRM.ui.showDataServiceError=function(t,i){var r=n.isArray(t)?t:[t];i=i||XRM.localize("error.dataservice.default");n.each(r,function(n,t){try{var r=JSON.parse(t.responseText);r&&r.error&&r.error.message&&r.error.message.value&&(i+="\n\n"+r.error.message.value);r&&r.error&&r.error.innererror&&r.error.innererror.internalexception&&r.error.innererror.internalexception.message&&(i+="\n\n"+r.error.innererror.internalexception.message)}catch(u){}});XRM.ui.showError(i)}});XRM.onActivate(function(){var n=XRM.namespace("editable.Attribute"),t=XRM.jQuery,i=XRM.util.parseUri;n.initialize=function(){t(".xrm-attribute").each(function(){n.initializeAttribute(t(this))})};n.initializeAttribute=function(t){var r=t.children("a.xrm-attribute-ref"),i=t.data("editable-url")||r.attr("href"),u=t.data("editable-title")||r.attr("title")||t.data("label")||"",f=t.data("create-url"),o=t.data("create-initial")||{},e=t.data("create-attribute");if(i){n.addClassOnEmptyValue(t);t.editable(i,{loadSuccess:function(r){n.enterEditMode(t,i,r,u)}});return}if(f&&e){n.addClassOnEmptyValue(t);t.editable(null,{loadSuccess:function(){n.enterCreateMode(t,f,o,e,u)}});return}};n.enterEditMode=function(r,u,f,e){var o,h,s,c,l,a;f&&f.d&&(o=i(u),o)&&(h=o.file,s=o.directory,h&&s)&&((s=s.replace(/\/$/,""),o.query&&(s+="?"+o.query),o.anchor&&(s+="#"+o.anchor),c=new RegExp(XRM.editable.editableClassRegexp).exec(r.attr("class")),!c||c.length<2)||(l=n.handlers[c[1]],t.isFunction(l))&&(a=f.d[h],l(r,e,h,a,s,function(){n.addClassOnEmptyValue(r)})))};n.enterCreateMode=function(i,r,u,f,e){var o=new RegExp(XRM.editable.editableClassRegexp).exec(i.attr("class")),s;!o||o.length<2||(s=n.handlers[o[1]+"_create"],t.isFunction(s))&&s(i,e,f,u,r,function(){n.addClassOnEmptyValue(i)})}});XRM.onActivate(function(){function i(t,i,r,e,o,s){var a,g,h,it,v,y,p,w,c,nt,tt,b,k,l,d;a=n("<div />").addClass(u).appendTo(document.body);g=n("<div />").addClass("xrm-editable-panel xrm-editable-dialog xrm-editable-dialog-html").appendTo(a);b=t.attr("data-languageContext");h=new YAHOO.widget.Panel(g.get(0),{close:!0,draggable:!0,constraintoviewport:!0,visible:!1,context:[document.body,"tl","tl",["windowResize"]],underlay:"none",zindex:XRM.zindex,width:n(window).width()-25+"px",height:n(window).height()-25+"px"});k=XRM.localize("editable.label.prefix")+i;b&&(k+=window.ResourceManager.Language_Label_With_Language.replace("{0}",b));h.setHeader(k);h.setBody(" ");l="xrm-adx-ckeditor-text";d="xrm-adx-ckeditor";it=n('<textarea id="'+l+'" style="display:none;visibility: hidden"/>').text(e||"").appendTo(h.body);var ft=n('<div id ="'+d+'" style="height:100%;overflow:hidden;"><div />').appendTo(h.body),rt=new MscrmControls.CkEditorCustomControl.CKEditorCustomToolbar("Portals",[{name:"document",items:["Source","-","Save","NewPage","Preview","Print","-","Templates","XrmSave","Ace"]},{name:"clipboard",items:["Cut","Copy","Paste","PasteText","PasteFromWord","Undo","Redo"]},{name:"editing",items:["Find","Replace","-","SelectAll","-","Scayt"]},{name:"links",items:["Link","Unlink","Anchor"]},{name:"insert",items:["Image","Flash","Table","HorizontalRule","Smiley","SpecialChar","PageBreak","Iframe","CmsTemplate"]},{name:"forms",items:["Form","Checkbox","Radio","TextField","Textarea","Select","Button","ImageButton","HiddenField"]},{name:"tools",items:["ShowBlocks"]},"/",{name:"basicstyles",items:["Bold","Italic","Underline","Strike","Subscript","Superscript","-","CopyFormatting","RemoveFormat"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock","-","BidiLtr","BidiRtl","Language"]},"/",{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"about",items:["About"]}]),ut=new MscrmControls.CkEditorCustomControl.EventListener(Editor.EventConstants.standardCkEditorInitialized,function(i){var r=CKEDITOR.instances[i.ckEditorInstanceName],u;c=function(){h.cfg.setProperty("width",n(window).width()-25+"px");h.cfg.setProperty("height",n(window).height()-25+"px");r.resize(n(window).width()-25,n(window).height()-50)};u=function(){h.align("tl","tl")};n(window).resize(c);n(window).scroll(u);h.beforeHideEvent.subscribe(function(){if(r.checkDirty())if(confirm(XRM.localize("confirm.unsavedchanges")))n(window).off("resize",c),n(window).off("scroll",u);else return!1;else n(window).off("resize",c),n(window).off("scroll",u)});r.setKeystroke(CKEDITOR.CTRL+83,"xrmsave");r.on("save",function(i){function e(){r.setReadOnly(!1);h.hide();n.isFunction(o)&&o()}var r=i.editor,u=n("#"+l).val();r.setReadOnly(!0);r.checkDirty()||e();s(u,{success:function(){function o(n){return n&&n.length>0&&/\S/.test(n)}function i(i){tt?n(".xrm-attribute-value",t).text(i):n(".xrm-attribute-value",t).html(i);o(i)?t.removeClass("no-value"):t.addClass("no-value")}r.resetDirty();nt&&y?shell.ajaxSafePost({method:"POST",url:y,contentType:"application/json",data:f.stringify({source:u})}).done(function(n){i(n)}).fail(function(){i(u)}).always(function(){e()}):(i(u),e())},error:function(n){r.setReadOnly(!1);XRM.ui.showDataServiceError(n)}})})}.bind(this));(new MscrmControls.CkEditorCustomControl.CKEditorFactory).create(d,l,rt,["/css/bootstrap.min.css","/css/ckeditor.css"],e,[ut],function(){var r=n("[data-app-path]").data("app-path")||"/",i=r+"xrm-adx/js/ckeditor_plugins/";CKEDITOR.plugins.addExternal("xrmsave",i+"xrmsave/","plugin.js");CKEDITOR.plugins.addExternal("ace",i+"ace/","plugin.js");CKEDITOR.plugins.addExternal("select2",i+"select2/","plugin.js");CKEDITOR.plugins.addExternal("cmstemplate",i+"cmstemplate/","plugin.js");(CKEDITOR.stylesSet.registered.cms==null||CKEDITOR.stylesSet.registered.cms==undefined)&&CKEDITOR.stylesSet.add("cms",[{name:window.ResourceManager.CKEditor_Code_Style,element:"code"},{name:window.ResourceManager.CKEditor_Code_Block_Style,element:"pre",attributes:{"class":"linenums prettyprint"}}]);CKEDITOR.config.removePlugins=CKEDITOR.config.removePlugins.split(",").filter(function(n){return n!=="contextmenu"}).join();CKEDITOR.config=n.extend(!0,CKEDITOR.config,XRM.ckeditorSettings);v=t.data("cmstemplate-url");v&&(CKEDITOR.config.cmstemplates=v);y=t.data("cmstemplate-render-url");tt=t.attr("data-encoded")=="true";nt=t.attr("data-liquid")=="true";p=t.data("filebrowser-url")||n("a.xrm-filebrowser-ref",t).attr("href");w=t.data("filebrowser-dialog-url")||n("a.xrm-filebrowser-dialog-ref",t).attr("href");p&&w&&(CKEDITOR.config.filebrowserBrowseUrl=XRM.util.updateQueryStringParameter(w,"url",encodeURIComponent(p)))}.bind(this));h.render();h.hideEvent.subscribe(function(){a.remove()});h.show();XRM.ui.registerOverlay(h);h.focus()}var t=XRM.namespace("editable.Attribute.handlers"),r=XRM.namespace("editable.Attribute"),n=XRM.jQuery,u=XRM.yuiSkinClass,f=YAHOO.lang.JSON;XRM.localizations["filebrowser.header.label"]=window.ResourceManager.FileBrowser_Header_Label;t.html=function(n,r,u,f,e,o){typeof CKEDITOR=="undefined"?t.textarea(n,r,u,f,e,o):i(n,r,u,f,o,function(n,t){XRM.data.services.putAttribute(e,u,n,{success:t.success,error:t.error})})};t.html_create=function(u,f,e,o,s,h){typeof CKEDITOR=="undefined"?t.textarea_create(u,f,s,o,createAttribute,h):i(u,f,e,u.data("default")||"",h,function(t,i){var f=o||{};f[e]=t;XRM.data.postJSON(s,f,{processData:!0,success:function(t){var f=u.data("editable-uritemplate");u.noneditable();f&&t&&t.d&&(u.removeAttr("data-create-url").data("create-url",null),u.attr("data-editable-url",XRM.util.expandUriTemplate(f,t.d)),r.initializeAttribute(u));n.isFunction(i.success)&&i.success(t)},error:i.error})})}});XRM.onActivate(function(){function i(t,i,r,u,f,s,h){function a(t){t.cancel();v.remove();n.isFunction(f)&&f()}function g(n){a(n)}function d(i){var f=n(".xrm-text",i.body),r=f.val(),e=n(i.footer);r!=u?(e.hide(),f.hide(),l.addClass("xrm-editable-wait"),h(r,{success:function(){function f(n){return n&&n.length>0&&/\S/.test(n)}function u(i){k?n(".xrm-attribute-value",t).text(i):n(".xrm-attribute-value",t).html(i);f(i)?t.removeClass("no-value"):t.addClass("no-value")}b&&y?n.ajax({method:"POST",url:y,contentType:"application/json",data:o.stringify({source:r})}).done(function(n){u(n)}).fail(function(){u(r)}).always(function(){a(i)}):(u(r),a(i))},error:function(n){l.removeClass("xrm-editable-wait");e.show();f.show();XRM.ui.showDataServiceError(n)}})):a(i)}var v,l,c,y,b,k,p,w;v=n("<div />").addClass(e).appendTo(document.body);l=n("<div />").addClass("xrm-editable-panel xrm-editable-dialog").addClass(s).appendTo(v);y=t.data("cmstemplate-render-url");k=t.attr("data-encoded")=="true";b=t.attr("data-liquid")=="true";p=t.attr("data-languageContext");c=new YAHOO.widget.Dialog(l.get(0),{visible:!1,constraintoviewport:!0,zindex:XRM.zindex,xy:YAHOO.util.Dom.getXY(t.get(0)),buttons:[{text:XRM.localize("editable.save.label"),handler:function(){d(this)},isDefault:!0},{text:XRM.localize("editable.cancel.label"),handler:function(){g(this)}}]});w=XRM.localize("editable.label.prefix")+i;p&&(w+=window.ResourceManager.Language_Label_With_Language.replace("{0}",p));c.setHeader(w);c.setBody(" ");n("<textarea />").addClass("xrm-text").val(u||"").appendTo(c.body);n(".xrm-text",c.body).keypress(function(n){return(n.which=="s".charCodeAt(0)&&n.ctrlKey)?(d(c),!1):!0});c.render();c.show();XRM.ui.registerOverlay(c);c.focus();n(".xrm-text",c.body).focus()}function r(n){return function(t,r,u,f,e,o){i(t,r,u,f,o,n,function(n,t){XRM.data.services.putAttribute(e,u,n,{success:t.success,error:t.error})})}}function u(t){return function(r,u,e,o,s,h){i(r,u,e,r.data("default")||"",h,t,function(t,i){var u=o||{};u[e]=t;XRM.data.postJSON(s,u,{processData:!0,success:function(t){var u=r.data("editable-uritemplate");r.noneditable();u&&t&&t.d&&(r.removeAttr("data-create-url").data("create-url",null),r.attr("data-editable-url",XRM.util.expandUriTemplate(u,t.d)),f.initializeAttribute(r));n.isFunction(i.success)&&i.success(t)},error:i.error})})}}var t=XRM.namespace("editable.Attribute.handlers"),f=XRM.namespace("editable.Attribute"),n=XRM.jQuery,e=XRM.yuiSkinClass,o=YAHOO.lang.JSON;t.textarea=r("xrm-editable-dialog-html-fallback");t.textarea_create=u("xrm-editable-dialog-html-fallback");t.text=r("xrm-editable-dialog-textarea");t.text_create=u("xrm-editable-dialog-textarea")});XRM.onActivate(function(){function i(i,r,u){this._element=t(i);this._id=r;this._language=u;this._rendered=!1;this._dateOnly=!1;this._dateFormat=n.convert(this._element.closest("[data-dateformat]").data("dateformat")||"M/d/yyyy",n.dotNet,n.momentJs);this._timeFormat=n.convert(this._element.closest("[data-timeformat]").data("timeformat")||"h:mm tt",n.dotNet,n.momentJs);this._dateTimeFormat=this._dateOnly?this._dateFormat:n.convert(this._element.closest("[data-datetimeformat]").data("datetimeformat"),n.dotNet,n.momentJs)||this._dateFormat+" "+this._timeFormat;this._dateIcon=this._element.closest("[data-datetimepicker-date-icon]").data("datetimepicker-date-icon")||"icon-calendar fa fa-calendar";this._timeIcon=this._element.closest("[data-datetimepicker-time-icon]").data("datetimepicker-time-icon")||"icon-time fa fa-clock-o"}var r=XRM.namespace("ui"),t=XRM.jQuery,u=window.moment,n=window.dateFormatConverter;i.prototype.getSelectedDateTime=function(){var n;return this._rendered?(n=t("#"+this._id+" input",this._element||document).val().trim(),!n)?null:this._element.datetimepicker({format:this._dateTimeFormat,useStrict:!0,locale:this._language}).data("DateTimePicker").date().utc().toDate():null};i.prototype.render=function(n,i){function a(){return/(iPod|iPhone|iPad)/i.test(navigator.userAgent.toLowerCase())}function v(){return/android/i.test(navigator.userAgent.toLowerCase())}function o(n){var i=t.Event("keyup",{which:n});c.trigger(i)}function l(){e&&e.focus()}if(!this._rendered){var s,h,r,c,e,f={tab:9,9:"tab",escape:27,27:"escape",enter:13,13:"enter"};n&&(s=u(n).toDate());h={defaultDate:s,format:this._dateTimeFormat,useCurrent:!1,useStrict:!0,locale:this._language,icons:{time:"icon-time adx-icon adx-icon-clock-o",date:"icon-calendar adx-icon adx-icon-calendar",up:"icon-chevron-up adx-icon adx-icon-chevron-up",down:"icon-chevron-down adx-icon adx-icon-chevron-down"},keyBinds:{enter:function(){this.toggle();o(f.enter);l()},escape:function(){this.hide();o(f.escape);l()}}};r=t("<div />").addClass("input-append input-group datetimepicker").attr("id",this._id);c=t("<input />").attr("type","text").attr("placeholder",window.ResourceManager.Datetimepicker_Datepicker_Label).attr("aria-label",i+" "+window.ResourceManager.Datetimepicker_Datepicker_Label).addClass("form-control").appendTo(r);e=t("<span />").attr("tabindex","0").attr("role","button");a()||v()||e.attr("title",window.ResourceManager.Datetimepicker_Datepicker_Label);e.attr("aria-label",window.ResourceManager.Datetimepicker_Datepicker_Label).addClass("input-group-addon").append(t('<span class="fa fa-calendar" />')).appendTo(r);t(this._element).append(r);r.datetimepicker(h);this._rendered=!0;r.on("keydown",function(n){n.keyCode==f.enter&&r.data("DateTimePicker").show()});r.on("dp.change",function(){r.data("DateTimePicker").hide()});e.on("keyup",function(n){var t=n.keyCode||n.which;t==f.tab?o(f.tab):t==f.escape&&o(f.escape)})}};r.DateTimePicker=i});XRM.onActivate(function(){var t=XRM.namespace("editable.Entity"),n=XRM.jQuery,i=XRM.yuiSkinClass,f=YAHOO.lang.JSON,r,u,e,o;XRM.util.slugify=function(n){var t=encodeURI(n.replace("%","")),i=t.replace(/[^\.\w-\d%]/g,""),r=decodeURI(i);return r.replace(/^\s+/,"").replace(/\s+$/,"").toLowerCase().replace(/[\s:;=+]+/g,"-").replace(/[\.]+/g,".")};XRM.editable.editableClassRegexp=/xrm-editable-(\S+)/gi;t.initialize=function(i){n(".xrm-entity").each(function(){for(var f=n(this),e=f.attr("class"),o=new RegExp(XRM.editable.editableClassRegexp),r=null,u;r=o.exec(e);)!r||r.length<2||(u=t.handlers[r[1]],n.isFunction(u))&&u(f,i)})};t.deleteEntity=function(t,i){XRM.data.postJSON(i,{},{success:function(){var i=n(".xrm-adx-entity-parent-url-ref",t).attr("href");i?document.location=i:t.hasClass("xrm-entity-current")?document.location="/":n.isFunction(document.location.reload)?document.location.reload(!0):document.location=document.location},error:function(n){XRM.ui.showDataServiceError(n)}})};t.showCreationDialog=function(i,u){u=u||{};u.create=!0;n.isFunction(u.save)||(u.save=r);n.each(i.fields,function(n,t){t.defaultToRoot&&i.rootWebpage?t.value=i.rootWebpage:t.defaultToCurrent&&i.current&&(t.value=i.current);t.defaultToCurrentLang&&i.currentLanguage&&i.currentLanguage.Name&&i.currentLanguage.Id&&(t.value=i.currentLanguage)});t.showEntityDialog(i,u)};r=t.saveCreationDialog=function(n,t,i){i.processData=!0;u(n,t,i)};u=t.saveEntityDialog=function(i,u,f){var e,o,s,h,c;if(!i.uri){XRM.log('"form.uri" must be defined.',"error","XRM.editable.Entity.saveEntityDialog");return}f=f||{};n.isFunction(f.success)||(f.success=function(){});e=f.disableProgress?function(){}:XRM.ui.showModalProgressPanel(XRM.localize("editable.saving"));o=n.isFunction(f.error)?function(n,t,i){e();f.error(n,t,i)}:function(n,t,i){e();XRM.log(t+":"+i,"error");XRM.ui.showDataServiceError(n)};h=n.map(u.__new__||[],function(t){return t.data?function(i){var u=n.Deferred(),f=i&&i.d&&t.uriTemplate?XRM.util.expandUriTemplate(t.uriTemplate,i.d):t.uri;return f?r({uri:f},t.data,{disableProgress:!0,success:function(){u.resolve()},error:function(){u.resolve()}}):u.resolve(),u.promise()}:null});delete u.__new__;c=n.map(i.fields||[],function(r){return!f.disableFileUploads&&r.type==="file"&&(r.fileUploadUri||r.fileUploadUriTemplate)?function(u){var f=n.Deferred();return new t.Form.fieldTypes.file(i.entityName,r).upload(u,function(){console.log("resolved post-save file upload");f.resolve()}),f.promise()}:null});s=(h||[]).concat(c||[]);XRM.data.postJSON(i.uri,u,{processData:f.processData,httpMethodOverride:f.httpMethodOverride,success:function(t){function r(){e();f.success()}function u(){var n=null,u;if(i.urlServiceUri?n=i.urlServiceUri:i.urlServiceUriTemplate&&t&&t.d&&(n=XRM.util.expandUriTemplate(i.urlServiceUriTemplate,t.d)),u=i.urlServiceOperationName,n===null||!u){r();return}XRM.data.getJSON(n,{success:function(n){if(n&&n.d&&n.d[u]){var t=n.d[u];t&&(XRM.util.isSameDomain(document.location,t)?document.location.href=f.preserveQueryString&&t.indexOf("?")<0?t+document.location.search:t:XRM.log('Returned redirect URL "'+t+'" is not equal to current document.location.host "'+document.location.host+'". Skipping redirect.',"error"))}r()},error:function(){r()}})}n.when.apply(n,n.map(s,function(n){return n(t)})).then(function(){i.reload?(r(),document.location.href=document.location.href.split("#")[0]):u()})},error:o})};t.showEditDialog=function(i,r){function f(n,t,i){u();XRM.log(t+": "+i,"error","XRM.editable.Entity.showEditDialog");XRM.ui.showDataServiceError(n,XRM.localize("error.dataservice.loading"))}if(!i.uri)return XRM.log('"form.uri" must be defined.',"error","XRM.editable.Entity.showEditDialog");r=r||{};r.edit=!0;n.isFunction(r.save)||(r.save=e);var u=XRM.ui.showModalProgressPanel("Loading...");XRM.data.getJSON(i.uri,{success:function(f){if(u(),!(f&&f.d)){XRM.ui.showError(XRM.localize("error.dataservice.loading"));return}n.each(i.fields,function(n,r){var u=f.d,h=t.getPropertyName(i.entityName,r.name),s,e,o;if(r.create&&r.create.uriTemplate&&(r.create.uri=XRM.util.expandUriTemplate(r.create.uriTemplate,f.d)),h){for(s=h.split("."),e=0;e<s.length;e++)if(u=u[s[e]],typeof u=="undefined")break;(o=u,typeof o!="undefined")&&(r.value=o,r.uriTemplate&&(r.uri=r.type==="parent"?XRM.util.expandUriTemplate(r.uriTemplate,f.d):XRM.util.expandUriTemplate(r.uriTemplate,o)))}});t.showEntityDialog(i,r)},error:f})};t.showDeletionDialog=function(r,u,f,e){function c(t){t.cancel();h.remove();n(document.body).removeClass(i)}function l(){t.deleteEntity(r,u);c(this)}function a(){c(this)}var h=n("<div />").addClass("xrm-editable-panel xrm-editable-dialog").appendTo(document.body),o=new YAHOO.widget.SimpleDialog(h.get(0),{fixedcenter:!0,visible:!1,draggable:!1,close:!1,modal:!0,icon:YAHOO.widget.SimpleDialog.ICON_WARN,constraintoviewport:!0,buttons:[{text:XRM.localize("confirm.yes"),handler:l,isDefault:!0},{text:XRM.localize("confirm.no"),handler:a}]}),s;o.setHeader(" ");o.setBody(" ");n("<span />").text(XRM.util.StringFormatter.format(XRM.localize("editable.delete.tooltip.prefix"),f)).appendTo(o.header);n("<p />").text(XRM.util.StringFormatter.format(XRM.localize("confirm.delete.entity.prefix"),f)).appendTo(o.body);s=t.getSiteMarkerWarning(r,f);s&&n("<p />").text(s).appendTo(o.body);e&&n("<p />").text(e).appendTo(o.body);n(document.body).addClass(i);o.render();o.show();XRM.ui.registerOverlay(o);o.focus()};t.getSiteMarkerWarning=function(t,i){var r=[];return(n(".xrm-entity-adx_webpage_sitemarker",t).each(function(){r.push('"'+n(this).attr("title")+'"')}),r.length<1)?null:(r.length=1)?XRM.util.StringFormatter.format(XRM.localize("sitemarker.warningmessage"),i,r.join(", ")):XRM.util.StringFormatter.format(XRM.localize("sitemarkers.warningmessage"),i,r.join(", "))};e=t.saveEditDialog=function(n,t,i){i.httpMethodOverride="MERGE";i.processData=!1;i.preserveQueryString=!0;u(n,t,i)};t.showEntityDialog=function(r,u){function b(n,t,i,f){function o(){var t=/\/_services\/portal\/[A-Za-z0-9-]*/g.exec(r.uri)[0];return[t,"adx_webpage",n,"__children"].join("/")}var e=o();XRM.data.getJSON(e,{success:function(n){var e,o;if(!(n&&n.d)){i(XRM.localize("error.dataservice.loading"));return}if(e=n.d.filter(function(n){return n.Url&&n.Url===t}),e.length){if((u.edit||r.current.optionsEdit)&&(o=e.filter(function(n){return n.Id===r.current.Id}),o.length)){f.resolve();return}i(XRM.localize("validation.childpage.partialurl.not.unique"));return}f.resolve()},error:function(){i(XRM.localize("error.dataservice.loading"))}})}function l(n){n.cancel()}function k(){this.cancel()}function d(){function i(i){n("<span />").addClass("xrm-dialog-validation-message").text(i).appendTo(n(".xrm-dialog-validation-summary",f.body));t.state()==="pending"&&t.reject()}var f=this,t=n.Deferred(),e,s;n(".xrm-dialog-validation-summary .xrm-dialog-validation-message",f.body).remove();n.each(o,function(r,u){if(u.validate(f.body)){if(u.name=="adx_partialurl"){var s=n("#"+this.id).val(),h=_.find(o,function(n){return n.name==="adx_parentpageid"}),c=h?n("#"+h.id).val():"",l=u._entityName;if(s==="/"&&c.length>0&&i(XRM.util.StringFormatter.format(XRM.localize("validation.childpage.partialurl.notslash.message"),u.label)),s!=="/"||h){var a=encodeURI(s.replace(/[%<>]/g,"")),v=a.replace(/[^\.\w-_\d%]/g,""),y=decodeURI(v);y.length<s.length&&i(XRM.util.StringFormatter.format(XRM.localize("validation.childpage.partialurl.notslash.message"),u.label))}s==="/"||c.length||l!=="adx_webpage"||i(XRM.util.StringFormatter.format(XRM.localize("validation.homepage.partialurl.notslash.message"),u.label));u.validatePartialUrl(s)&&i(XRM.util.StringFormatter.format(XRM.localize("validation.partialurl.suffix"),u.label));h&&t.state()==="pending"&&(e=b.bind(null,c,s,i,t))}}else i(XRM.util.StringFormatter.format(XRM.localize("validation.required.suffix"),u.label))});t.state()==="rejected"||e?e&&(s=XRM.ui.showModalProgressPanel(XRM.localize("editable.loading")),e()):t.resolve();t.promise().then(function(){var t={};n.each(o,function(i,u){u.appendData(t,f.body);var e=n.grep(r.fields,function(n){return n.name==u.name});e.length>0&&e[0].defaultToCurrentLang&&e[0].value!=null&&(t[u.name]={Id:e[0].value.Id,LogicalName:e[0].value.LogicalName})});u.save(r,t,{success:function(){l(f)}})});t.always(function(){s&&s()})}function y(t,i){n.each(t,function(t,r){var u=n("<div />").addClass("xrm-dialog-column").appendTo(i);r.cssClass&&u.addClass(r.cssClass);n.each(r.fields,function(t,i){var e=n.grep(o,function(n){return n.name==i}),r,f,s;e.length>0&&(r=e[0],r)&&(f=n("<div />").addClass("xrm-dialog-section").appendTo(u),s=n("<label />").attr("for",r.id).text(r.label+(r.required?" "+XRM.localize("editable.required.label"):"")).appendTo(f),r.render(f,s))})})}function w(){e.full&&s.width(n(window).width()-100);f.render();n(".container-close").attr("role","button").attr("title",window.ResourceManager.Close_DefaultText);h();a.show();n(document.body).addClass(i);n.each(o,function(n,t){t.show(f)});e.full&&n(f.body).height(n(window).height()-180);f.show();XRM.ui.registerOverlay(f);f.focus();a.css("z-index",n(f.element).css("z-index")-1);n("input:first",f.body).focus()}function it(n){v.push(n);v.length==c.length&&w()}function rt(n,t){h();l(f);XRM.ui.showDataServiceError(t,XRM.localize("error.dataservice.loading"))}function ut(n){h();l(f);XRM.ui.showError(n)}var e,s,o,h,c,v;if(u=u||{},!r){XRM.log('"form" cannot be null.',"error","XRM.editable.Entity.showEntityDialog");return}e=r.layout;e||(e={columns:[{fields:n.map(r.fields,function(n){return n.name})}]});s=n("<div />").addClass("xrm-editable-panel xrm-editable-dialog xrm-editable-dialog-create").appendTo(document.body);s.addClass("xrm-editable-dialog-"+r.entityName);e.cssClass&&s.addClass(e.cssClass);e.full&&s.addClass("xrm-editable-dialog-full");o=n.map(r.fields,function(n){if(n.disableAtRoot&&r.root&&u.edit)return null;var i=t.Form.fieldTypes[n.type];return i?new i(r.entityName,n):null});var f=new YAHOO.widget.Dialog(s.get(0),{visible:!1,constraintoviewport:!0,fixedcenter:"contained",zindex:XRM.zindex,modal:!1,buttons:[{text:XRM.localize("editable.save.label"),handler:d,isDefault:!0},{text:XRM.localize("editable.cancel.label"),handler:k}]}),a=n("<div />").addClass("xrm-modal-backdrop").css("z-index",XRM.zindex).hide().appendTo(document.body),g=n(document.body).hasClass(i);if(f.subscribe("cancel",function(){s.remove();g||n(document.body).removeClass(i);a.remove();n.isFunction(u.cancel)&&u.cancel()}),f.setHeader(" "),n("<span />").text(u.edit?r.editTitle||r.title:r.title).appendTo(f.header),f.setBody(" "),e.tabs){var p=n("<div>").attr("role","tabpanel").appendTo(f.body),nt=n("<ul>").addClass("xrm-tabs").attr("role","tablist").appendTo(p),tt=n("<div>").addClass("xrm-tabcontent").appendTo(p);n.each(e.tabs,function(t,i){var u=t==0,o="xrm-editable-tab-"+r.entityName+"-"+i.id,s=n("<li>").attr("role","presentation").appendTo(nt),f=n("<div>").addClass("xrm-tabpanel").attr("id",o).attr("role","tabpanel").attr("aria-labelledby","tab-"+i.id).appendTo(tt),e;u&&(s.addClass("active"),f.addClass("active"));f.attr("aria-expanded",u);e=n("<a>").attr("href","#"+o).attr("title",i.tooltip||i.label).attr("role","tab").attr("id","tab-"+i.id).attr("aria-expanded",u).text(i.label).appendTo(s).click(function(t){t.preventDefault();var i=n(this),r=i.closest("ul"),u=i.parent("li"),f=n(i.attr("href"));u.hasClass("active")||(r.find("> .active").find("a").attr("aria-expanded",!1),r.find("> .active").removeClass("active"),u.addClass("active"),i.attr("aria-expanded",!0),f.parent().find("> .active").removeClass("active").attr("aria-expanded",!1),f.addClass("active").attr("aria-expanded",!0))});i.icon&&(e.prepend("&nbsp;"),n("<span>").addClass(i.icon).attr("aria-hidden",!0).prependTo(e));y(i.columns||[],f)})}else y(e.columns,f.body);if(n("<div />").addClass("xrm-dialog-validation-summary").appendTo(f.body),n.each(o,function(t,i){var u,r;if(i.slugify&&!n("#"+i.id,f.body).val())for(u=n.grep(o,function(n){return n.name==i.slugify}),r=0;r<u.length;r++)n("#"+i.id,f.body).syncSlugify(n("#"+u[r].id,f.body))}),h=XRM.ui.showModalProgressPanel(XRM.localize("editable.loading")),c=n.grep(o,function(n){return n.requiresLoading}),c.length<1){w();return}v=[];n.each(c,function(n,t){XRM.data.getJSON(t.uri,{success:function(n){if(!(n&&n.d)){ut(XRM.localize("error.dataservice.loading.field.prefix")+t.label+".");return}t.load(n,f.body);it(t)},error:function(n){rt(t,n)}})})};t.configureDateTimeField=function(n,t){if(n.type==="datetime"){var i=t.data("cultureinfo-datetimeformat");if(i)try{n.dateTimeFormat=typeof i=="string"?f.parse(i):i}catch(r){n.dateTimeFormat=null}}};o=XRM.namespace("data");XRM.data.postJSON=function(n,t,i){var u="application/json, text/javascript",r;i=i||{};r=o.getReponseHandler(i.success);shell.ajaxSafePost({beforeSend:function(n){n.setRequestHeader("Accept",u);i.httpMethodOverride&&n.setRequestHeader("X-HTTP-Method",i.httpMethodOverride)},url:n,type:"POST",processData:i.processData||!1,dataType:r.dataType,contentType:"application/json",data:t?f.stringify(t):null,success:r.handler,error:i.error})}});XRM.onActivate(function(){function f(n){var i="yuiIO"+this._transaction_id,r=YAHOO.env.ua.ie>=9?!0:!1,t;YAHOO.env.ua.ie&&!r?(t=document.createElement('<iframe id="'+i+'" name="'+i+'" />'),typeof n=="boolean"&&(t.src="javascript:false")):(t=document.createElement("iframe"),t.id=i,t.name=i);t.style.position="absolute";t.style.top="-1000px";t.style.left="-1000px";document.body.appendChild(t);YAHOO.log("File upload iframe created. Id is:"+i,"info","Connection")}function u(n,t){e(n);XRM.util.isAppleOrAndroid()?setAriahidden(n,t.label):o(n,t)}function e(){var t=n(".select2-hidden-accessible");t.length===0?t=n("<span>",{}).addClass("select2-hidden-accessible").appendTo(document.body):(t.removeAttr("role"),t.removeAttr("aria-live"))}function o(n,t){var r=n.parents(".xrm-select-control").find(".select2-container"),i=r.find(".select2-focusser").attr("aria-expanded","false");i.attr("aria-labelledby","select2-offscreen");i.attr("role","combobox");i=r.find("label.select2-offscreen")[0];i.textContent=t.label+(t.required?" "+XRM.localize("editable.required.label"):"")}var t=XRM.namespace("editable.Entity.Form"),n=XRM.jQuery,i=YAHOO.lang.JSON,r=XRM.editable.Entity;t.fieldTypes&&t.FieldType||XRM.log("Unable to extend XRM.editable.Entity.Form.fieldTypes.","warn");XRM.localizations["entity.form.select.new"]=window.ResourceManager.Entity_Form_Select_New;t.fieldTypes.text=t.fieldTypes.text.extend({render:function(t){var r=this._data,f={},u=n('<input type="text" class="xrm-text" />').appendTo(t),i;r.disabled&&(u.attr("readonly","readonly"),u.addClass("xrm-text-disabled"));f={id:this.id,name:this.id};r.maxlength&&(f.maxlength=r.maxlength);u.attr(f);i=r.formatter;i&&"function"==typeof i||(i=function(n){return n||""});typeof this._initialValue!="undefined"&&this._initialValue!==null&&u.val(i(this._initialValue))},validate:function(n){return!!(!this.required||this.getValue(n).trim())},validatePartialUrl:function(n){return/^(http|https|ftp)/i.test(n)}});t.fieldTypes.file=t.fieldTypes.file.extend({upload:function(t,i){var h=YAHOO.util.Connect.createFrame,e,r,o,u,s;if(YAHOO.util.Connect.createFrame=f,e=this._data,r=null,e.fileUploadUri?r=e.fileUploadUri:e.fileUploadUriTemplate&&t&&t.d&&(r=XRM.util.expandUriTemplate(e.fileUploadUriTemplate,t.d)),r!==null){if(!XRM.util.isSameDomain(document.location,r)){o='Host of upload URI "'+r+'" is not equal to current document.location.host "'+document.location.host+'". File upload failed.';XRM.log(o,"error");alert(o);i(this);return}u=n("<form />").attr("id",this.id+"-form").attr("action",r).attr("enctype","multipart/form-data").attr("method","post").hide();s=this;shell.getTokenDeferred().done(function(t){n("<input>").attr("name","__RequestVerificationToken").attr("type","hidden").appendTo(u).val(t);u.appendTo(document.body);n("#"+s.id).wrap(u);YAHOO.util.Connect.setForm(u.attr("id"),!0,!0);YAHOO.util.Connect.asyncRequest("POST",r,{upload:function(){u.remove();i(s)}});YAHOO.util.Connect.createFrame=h})}}});t.fieldTypes.picklist=t.FieldType.extend({appendData:function(n,t){return this._disabled?n:this._super(n,t)},getValue:function(t){var i=n("#"+this.id,t||document).val();return i===""?null:i},render:function(t){var o=n("<select />").attr("id",this.id).attr("name",this.id).appendTo(t),r,s,u,f,e;this.required||n("<option />").val("").html("&nbsp;").prop("selected",!0).appendTo(o);r=this._entityName+"."+this.name;s=n('.xrm-entity-picklist[title="'+r+'"]').text();try{u=i.parse(s)}catch(h){XRM.log("Unable to load picklist "+r+". "+h,"warn");this._disabled=!0;t.hide();return}if(!n.isArray(u)){XRM.log("Unable to load picklist "+r+". JSON is not an array.","warn");this._disabled=!0;t.hide();return}for(f=0;f<u.length;f++)e=u[f],n("<option />").val(e.Key).text(e.Value).prop("selected",this._initialValue==e.Key).appendTo(o)},validate:function(n){return this._disabled||this._super(n)}});t.fieldTypes.datetime=t.fieldTypes.datetime.extend({appendData:function(n){return n[this.propertyName]=this._picker.getSelectedDateTime(),n},init:function(t,i){this._super(t,i);i.defaultToNow&&!this._initialValue&&(this._initialValue="Date("+(new Date).getTime()+")");this._language=n("html").attr("lang")},render:function(n){var t=new XRM.ui.DateTimePicker(n,this.id,this._language);t.render(this._initialValue,this.label);this._picker=t}});t.fieldTypes.select=t.fieldTypes.select.extend({appendData:function(t,i){var o=n("#"+this.id,i||document),r=o.find(":selected"),u,e,f;return r.val()!="new"?this._super(t,i):(u=r.data("new"),e=r.data("uri"),f=r.data("uri-template"),u&&f&&(n.isArray(t.__new__)||(t.__new__=[]),t.__new__.push({uri:e,uriTemplate:f,data:u})),t)},load:function(t,i){function f(n){return r.optionEntityName?XRM.editable.Entity.getPropertyName(r.optionEntityName,n):n}var e=n("#"+this.id,i||document),r=this._data,h=n.isArray(t.d)?t.d:[],s;r.sortby&&(s=f(r.sortby),h.sort(function(n,t){var i=n[s],r=t[s];return i<r?-1:i==r?0:1}));var l=f(r.optionText),c=f(r.optionValue),a=f("adx_isdefault"),o=r.optionDescription?f(r.optionDescription):null,v=r.value!=null&&typeof r.value!="undefined"?function(n){return n[c]===(r.value.Id||r.value)}:function(n){return!!n[a]};n.each(h,function(t,i){var r=n("<option />").val(i[c]).text(i[l]).prop("selected",v(i)).appendTo(e);o&&r.attr("data-description",i[o]||"")});n.fn.select2&&(e.css("display","block").css("width","100%"),e.select2({allowClear:!0,dropdownCssClass:"xrm-editable-select2"+(o?" xrm-editable-select2-with-descriptions":""),minimumResultsForSearch:5,formatResult:function(t){if(!o)return t.text;var i=n(t.element);return n("<div>").append(n("<div>").addClass("name").text(t.text)).append(n("<small>").addClass("description").text(i.data("description")))}}),u(e,r))},render:function(t){var i=n("<div>").addClass("xrm-select").appendTo(t),u=n("<div>").addClass("xrm-select-control").appendTo(i),r=n("<select />").attr("id",this.id).attr("name",this.id).appendTo(u);this.required||n("<option />").val("").html("&nbsp;").prop("selected",!0).appendTo(r);this.renderCreate(i,r)},renderCreate:function(t,i){function l(n){return f.optionEntityName?XRM.editable.Entity.getPropertyName(f.optionEntityName,n):n}var f=this._data,u=f.create||{},e,o,s,h,c;u.uriTemplate&&u.entityContainer&&(e=r.handlers[f.optionEntityName],e&&n.isFunction(e.getForm))&&(s=XRM.localize(u.title)||"New",o=e.getForm(u.entityContainer,{title:s,uri:u.uriTemplate}),o&&o.valid)&&(h=l(f.optionText),t.addClass("xrm-select-with-new"),c=n("<div>").addClass("xrm-new").appendTo(t),n("<button>").attr("type","button").attr("title",s).text(XRM.localize("")||"+ New").appendTo(c).click(function(){r.showEntityDialog(o,{save:function(t,r,f){i.children("option[value=new]").remove();n("<option />").val("new").text(r[h]).prop("selected",!0).data("new",r).data("uri",u.uri).data("uri-template",u.uriTemplate).appendTo(i);n.fn.select2&&n(i).select2("val","new");f.success()}})}))}});t.fieldTypes.parent=t.FieldType.extend({init:function(n,t){this._super(n,t);this.requiresLoading=!1},appendData:function(t,i){var u=n("#"+this.id,i||document),r;return u.prop("disabled")?t:(r=this.getValue(i),typeof r=="undefined"||r===null||r==="")?(this._data.excludeEmptyData||(t[this.propertyName]=null),t):(t[this.propertyName]={Id:r,LogicalName:this._data.optionEntityName},t)},render:function(t){var r=this._data,e=n("<div>").addClass("xrm-select").appendTo(t),o=n("<div>").addClass("xrm-select-control").appendTo(e),f=n("<input />").attr("type","hidden").attr("id",this.id).attr("name",this.id).appendTo(o),i=this._initialValue;if(this.required&&!(i&&i.LogicalName&&i.LogicalName==r.optionEntityName)){f.prop("disabled",!0);t.hide();return}if(f.css("width","100%"),i&&i.Id&&f.val(i.Id),!n.fn.select2){XRM.log("Select2 plugin not found. Disabling parent selector.","warn");t.hide();return}f.select2({allowClear:!this.required,placeholder:this.required?null:XRM.localize(r.placeholder||r.label)||r.label,dropdownCssClass:"xrm-editable-select2 xrm-editable-select2-with-descriptions",minimumInputLength:0,ajax:{url:r.uri,dataType:"json",quietMillis:250,data:function(n,t){return{search:n,page:t}},results:function(n){return{results:n.d,more:n.more}},cache:!0},id:function(n){return n.Id},initSelection:function(t,u){if(i&&i.Name){u(i);return}i&&i.Id&&n.ajax(XRM.util.updateQueryStringParameter(r.uri,"selectedId",i.Id),{dataType:"json"}).done(function(n){n&&n.d&&n.d[0]&&u(n.d[0])})},formatResult:function(t){for(var i=t.Path||[],r="",u=1;u<i.length;u++)r+="/ "+i[u]+" ";return t.Name&&(r+="/ "+(i.length<1?"":t.Name)),n("<div>").append(n("<div>").addClass("name").text(t.Name||t.Id)).append(n("<small>").addClass("description path").text(r))},formatSelection:function(n){return n.Name||n.Id}});u(f,r)},validate:function(t){var i=n("#"+this.id,t||document);return i.prop("disabled")||this._super(t)}});t.fieldTypes.instructions=t.FieldType.extend({appendData:function(n){return n},getValue:function(){return null},render:function(t){n("<input />").attr("type","hidden").attr("id",this.id).attr("name",this.id).appendTo(t)}});t.fieldTypes.textarea=t.FieldType.extend({render:function(t){var i=this._data,r=n("<textarea />").attr("id",this.id).attr("name",this.id).addClass("xrm-textarea").appendTo(t);typeof this._initialValue!="undefined"&&this._initialValue!==null&&r.val(this._initialValue||"");i.maxlength&&r.attr("maxlength",i.maxlength);i.height&&r.height(i.height)}});t.fieldTypes.integer=t.fieldTypes.text.extend({appendData:function(n,t){var i=this.getValue(t);return n[this.name]=i,n},getValue:function(t){var i=parseInt(n("#"+this.id,t||document).val());return isNaN(i)?null:i}});t.fieldTypes.html=t.FieldType.extend({getValue:function(){return this.textAreaId?n("#"+this.textAreaId).val():""},render:function(t){var i,u,r,f,e;this.textAreaId=this.id+"textArea";r=n("<textarea />").attr("id",this.textAreaId).attr("name",this.id).addClass("xrm-textarea").appendTo(t);f=n("<div><div />").attr("id",this.id).attr("name",this.id).addClass("xrm-html").appendTo(t);r.get(0).style.display="none";r.get(0).style.visibility="hidden";typeof this._initialValue!="undefined"&&this._initialValue!==null&&r.val(this._initialValue||"");typeof CKEDITOR!="undefined"?(i=n.extend(!0,{},XRM.ckeditorCompactSettings||{}),i.language=n("html").attr("crm-lang"),this._data.ckeditorSettings&&(i=n.extend(!0,i,this._data.ckeditorSettings)),i.height&&(u=parseInt(i.height),u&&(e=u+100,f.height(e),t.get(0).style.height=e+"px")),this._data.cmsTemplateUrl&&(i.cmstemplates=this._data.cmsTemplateUrl),this._data.fileBrowserServiceUri&&this._data.fileBrowserDialogUri&&(i.filebrowserBrowseUrl=XRM.util.updateQueryStringParameter(this._data.fileBrowserDialogUri,"url",encodeURIComponent(this._data.fileBrowserServiceUri))),this._editorElement=f.get(0),this._editorSettings=i):this._editor=null},show:function(){var i=this._editorSettings||{},t;this._editorElement&&(t=new MscrmControls.CkEditorCustomControl.CKEditorCustomToolbar("Portals",[{name:"document",items:["Source","-","Save","NewPage","Preview","Print","-","Templates","XrmSave","Ace"]},{name:"clipboard",items:["Cut","Copy","Paste","PasteText","PasteFromWord","Undo","Redo"]},{name:"links",items:["Link","Unlink","Anchor"]},{name:"editing",items:["Find","Replace","-","SelectAll","-","Scayt"]},{name:"insert",items:["Image","Flash","Table","HorizontalRule","Smiley","SpecialChar","PageBreak","Iframe"]},{name:"forms",items:["Form","Checkbox","Radio","TextField","Textarea","Select","Button","ImageButton","HiddenField"]},{name:"tools",items:["ShowBlocks"]},"/",{name:"basicstyles",items:["Bold","Italic","Underline","Strike","Subscript","Superscript","-","CopyFormatting","RemoveFormat"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock","-","BidiLtr","BidiRtl","Language"]},"/",{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"about",items:["About"]}]),(new MscrmControls.CkEditorCustomControl.CKEditorFactory).create(this._editorElement.id,this.id+"textArea",t,["/css/bootstrap.min.css","/css/ckeditor.css"],this._initialValue,[],function(){var i=n("[data-app-path]").data("app-path")||"/",t=i+"xrm-adx/js/ckeditor_plugins/";CKEDITOR.plugins.addExternal("xrmsave",t+"xrmsave/","plugin.js");CKEDITOR.plugins.addExternal("ace",t+"ace/","plugin.js");CKEDITOR.plugins.addExternal("select2",t+"select2/","plugin.js");CKEDITOR.plugins.addExternal("cmstemplate",t+"cmstemplate/","plugin.js");(CKEDITOR.stylesSet.registered.cms==null||CKEDITOR.stylesSet.registered.cms==undefined)&&CKEDITOR.stylesSet.add("cms",[{name:window.ResourceManager.CKEditor_Code_Style,element:"code"},{name:window.ResourceManager.CKEditor_Code_Block_Style,element:"pre",attributes:{"class":"linenums prettyprint"}}]);CKEDITOR.config.removePlugins=CKEDITOR.config.removePlugins.split(",").filter(function(n){return n!=="contextmenu"}).join();CKEDITOR.config=n.extend(!0,CKEDITOR.config,this._editorSettings)}.bind(this)))}});t.fieldTypes.iframe=t.FieldType.extend({appendData:function(t){var u=n("#"+this.id).get(0),i,r;return u?(i=u.contentWindow,!i)?t:(r=i.xrm_iframe,!r)?t:(t[this.propertyName]=r.getValue(),t):t},getValue:function(){var r=n("#"+this.id).get(0),t,i;return r?(t=r.contentWindow,!t)?null:(i=t.xrm_iframe,!i)?null:i.getValue():null},render:function(t){var i=this._data,r=this._initialValue,u=n("<iframe />").attr("id",this.id).attr("src",i.src).addClass("xrm-iframe").appendTo(t);u.on("load",function(){var n=u.get(0).contentWindow.xrm_iframe;n&&r!=="undefined"&&r!==null&&n.setValue(r)});i.height&&u.height(i.height)}});t.fieldTypes.customrender=t.FieldType.extend({render:function(n,t){var i=this._data;i&&i.render&&typeof i.render=="function"&&i.render(n,t)}});t.fieldTypes.checkbox=t.fieldTypes.checkbox.extend({render:function(t,i){i.addClass("xrm-checkbox");var r=n("<input />").attr("type","checkbox").attr("id",this.id).attr("name",this.id).prependTo(i);typeof this._initialValue!="undefined"&&this._initialValue!==null?r.prop("checked",this._initialValue):this._data.checkedByDefault&&r.prop("checked",!0)}});t.fieldTypes.tags=t.FieldType.extend({appendData:function(n,t){return n[this.name]=this.getValue(t),n},getValue:function(t){return n.map(n("#"+this.id,t).adxtags("tags"),function(n){return n.value})},render:function(t){var u=n('.xrm-entity-tags[title="'+this._entityName+'"]').text(),f=i.parse(u),r=f.tags;if(!n.isArray(r)){XRM.log("Unable to load tags for "+this._entityName+".","warn");return}this._availableTags=r;this._element=n("<ul />").attr("id",this.id).attr("name",this.id).appendTo(t)},show:function(){this._availableTags&&this._element&&this._element.adxtags({tagSource:this._availableTags,initialTags:n.isArray(this._initialValue)?this._initialValue:[],triggerKeys:["enter","comma"],highlightOnExistColor:"#426FD9"})},_getId:function(n){return"xrm-editable-"+(n||"").replace(/\./,"-")}}),function(n){n.widget("ui.adxtags",{options:{tagSource:[],triggerKeys:["enter","space","comma","tab"],initialTags:[],minLength:1,select:!1,allowNewTags:!0,caseSensitive:!1,highlightOnExistColor:"#0F0",emptySearch:!0,tagsChanged:function(){}},_splitAt:/\ |,/g,_existingAtIndex:0,_pasteMetaKeyPressed:!1,_keys:{backspace:[8],enter:[13],space:[32],comma:[44,188],tab:[9]},_create:function(){var t=this,r,i;this.tagsArray=[];this.timer=null;this.element.addClass("tagit");this.element.children("li").each(function(){var i=n(this).attr("tagValue");t.options.initialTags.push(i?{label:n(this).text(),value:i}:n(this).text())});t._splitAt=null;n.inArray("space",t.options.triggerKeys)>0&&n.inArray("comma",t.options.triggerKeys)>0?t._splitAt=/\ |,/g:n.inArray("space",t.options.triggerKeys)>0?t._splitAt=/\ /g:n.inArray("comma",t.options.triggerKeys)>0&&(t._splitAt=/,/g);this.element.html('<li class="tagit-new"><input class="tagit-input" type="text" /><\/li>');this.input=this.element.find(".tagit-input");n(this.element).click(function(i){var r,u,f;n(i.target).hasClass("tagit-close")?(r=n(i.target).parent(),r.remove(),u=r.attr("tagValue"),u?t._popTag(null,u):(f=r.text(),t._popTag(f.substr(0,f.length-1)))):(t.input.focus(),t.options.emptySearch&&n(i.target).hasClass("tagit-input")&&t.input.val()==""&&t.input.autocomplete!=undefined&&t.input.autocomplete("search"))});r=this.options.select;this.options.appendTo=this.element;this.options.source=this.options.tagSource;this.options.select=function(n,i){return clearTimeout(t.timer),i.item.label===undefined?t._addTag(i.item.value):t._addTag(i.item.label,i.item.value),!1};i=this.input;this.options.focus=function(n,t){if(t.item.label!==undefined&&/^key/.test(n.originalEvent.originalEvent.type))return i.val(t.item.label),i.attr("tagValue",t.item.value),!1};this.input.autocomplete(this.options);this.options.select=r;this.input.keydown(function(i){var r=t.element.children(".tagit-choice:last");if(i.which==t._keys.backspace)return t._backspace(r);t._isInitKey(i.which)&&(i.preventDefault(),t.options.allowNewTags&&(t.options.maxTags===undefined||t.tagsArray.length!=t.options.maxTags)?t.options.allowNewTags&&n(this).val().length>=t.options.minLength&&t._addTag(n(this).val()):t.input.val(""));t.options.maxLength!==undefined&&t.input.val().length==t.options.maxLength&&i.preventDefault();r.hasClass("selected")&&r.removeClass("selected");_pasteMetaKeyPressed=i.metaKey;t.lastKey=i.which});this.input.keyup(function(t){_pasteMetaKeyPressed&&(t.which==91||t.which==86)&&n(this).blur();window.setTimeout(function(){_pasteMetaKeyPressed=t.metaKey},250)});this.input.blur(function(){return t.currentLabel=n(this).val(),t.currentValue=n(this).attr("tagValue"),t.options.allowNewTags&&(t.timer=setTimeout(function(){t._addTag(t.currentLabel,t.currentValue);t.currentValue="";t.currentLabel=""},400)),n(this).val("").removeAttr("tagValue"),!1});String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};this.options.select&&(this.element.after('<select class="tagit-hiddenSelect" name="'+this.element.attr("name")+'" multiple="multiple"><\/select>'),this.select=this.element.next(".tagit-hiddenSelect"));this._initialTags()},_popSelect:function(n,t){this.select.children('option[value="'+(t===undefined?n:t)+'"]').remove();this.select.change()},_addSelect:function(t,i){var r=n("<option>").attr({selected:"selected",value:i===undefined?t:i}).text(t);this.select.append(r);this.select.change()},_popTag:function(t,i){var r,u;if(t===undefined)t=this.tagsArray.pop(),typeof t=="object"&&(i=t.value,t=t.label);else{if(i===undefined)r=-1,n.each(this.tagsArray,function(n,i){if(i&&i.label==t)return r=n,!1}),r=r==-1?this.tagsArray.length-1:r;else{r=this.tagsArray.length-1;for(u in this.tagsArray)if(this.tagsArray[u].value==i){r=u;break}}this.tagsArray.splice(r,1)}this.options.select&&this._popSelect(t,i);this.options.tagsChanged&&this.options.tagsChanged(i||t,"popped",null)},_addTag:function(t,i){var f,r,u;if(this.input.val(""),this._splitAt&&t.search(this._splitAt)>0){for(f=t.split(this._splitAt),r=0;r<f.length;r++)this._addTag(f[r],i);return}return(t=t.replace(/,+$/,""),t=t.trim(),t=="")?!1:this._exists(t,i)?(this._highlightExisting(),!1):(u="",u=n('<li class="tagit-choice"'+(i!==undefined?' tagValue="'+i+'"':"")+">"+t+'<a class="tagit-close">x<\/a><\/li>'),u.insertBefore(this.input.parent()),this.input.val(""),this.tagsArray.push(i===undefined?{label:t,value:t}:{label:t,value:i}),this.options.select&&this._addSelect(t,i),this.options.tagsChanged&&this.options.tagsChanged(t,"added",u),!0)},_exists:function(n,t){var r,i;if(this.tagsArray.length==0)return!1;if(t===undefined){this._existingAtIndex=0;for(i in this.tagsArray){if(r=typeof this.tagsArray[i]=="string"?this.tagsArray[i]:this.tagsArray[i].label,this._lowerIfCaseInsensitive(n)==this._lowerIfCaseInsensitive(r))return!0;this._existingAtIndex++}}else{this._existingAtIndex=0;for(i in this.tagsArray){if(this._lowerIfCaseInsensitive(t)===this._lowerIfCaseInsensitive(this.tagsArray[i].value))return!0;this._existingAtIndex++}}return this._existingAtIndex=-1,!1},_highlightExisting:function(){var t,i;this.options.highlightOnExistColor!==undefined&&(t=n(n(this.element).children(".tagit-choice")[this._existingAtIndex]),t.stop(),i=t.css("color"),t.animate({color:this.options.highlightOnExistColor},100).animate({color:i},800))},_isInitKey:function(t){var i="";for(var r in this._keys)n.inArray(t,this._keys[r])!=-1&&(i=r);return n.inArray(i,this.options.triggerKeys)!=-1?!0:!1},_removeTag:function(){this._popTag();this.element.children(".tagit-choice:last").remove()},_backspace:function(n){return this.input.val()==""&&(this.lastKey==this._keys.backspace?(this._popTag(),n.remove(),this.lastKey=null):(n.addClass("selected"),this.lastKey=this._keys.backspace)),!0},_initialTags:function(){var t=this,i;this.options.tagsChanged&&(i=this.options.tagsChanged);this.options.tagsChanged=null;this.options.initialTags.length!=0&&n(this.options.initialTags).each(function(n,i){typeof i=="object"?t._addTag(i.label,i.value):t._addTag(i)});this.options.tagsChanged=i},_lowerIfCaseInsensitive:function(n){return n===undefined||typeof n!="string"?n:this.options.caseSensitive?n:n.toLowerCase()},tags:function(){return this.tagsArray},destroy:function(){n.Widget.prototype.destroy.apply(this,arguments);this.tagsArray=[]},reset:function(){this.element.find(".tagit-choice").remove();this.tagsArray=[];this.options.select&&(this.select.children().remove(),this.select.change());this._initialTags();this.options.tagsChanged&&this.options.tagsChanged(null,"reseted",null)},fill:function(n){this.element.find(".tagit-choice").remove();this.tagsArray=[];n!==undefined&&(this.options.initialTags=n);this.options.select&&(this.select.children().remove(),this.select.change());this._initialTags()},add:function(t,i){var f,r,u;if(t=t.replace(/,+$/,""),this._splitAt&&t.search(this._splitAt)>0){for(f=t.split(this._splitAt),r=0;r<f.length;r++)this.add(f[r],i);return}return(t=t.trim(),t==""||this._exists(t,i))?!1:(u="",u=n('<li class="tagit-choice"'+(i!==undefined?' tagValue="'+i+'"':"")+">"+t+'<a class="tagit-close">x<\/a><\/li>'),u.insertBefore(this.input.parent()),this.tagsArray.push(i===undefined?t:{label:t,value:i}),this.options.select&&this._addSelect(t,i),this.options.tagsChanged&&this.options.tagsChanged(t,"added",u),!0)}})}(n)});XRM.onActivate(function(){var t=XRM.namespace("editable.Entity.Handler"),i=XRM.editable.Entity,n=XRM.jQuery,r=YAHOO.lang.JSON;t.getForm=function(t,r,u){var f=n.extend(!0,{},t),o;f.title=u.title;f.editTitle=XRM.ui.getEditTooltip(r);f.uri=u.uri;f.urlServiceUri=u.urlServiceUri;f.urlServiceUriTemplate=u.urlServiceUriTemplate;f.urlServiceOperationName=u.urlServiceOperationName;f.root=r.attr("data-root")=="true";f.currentLanguage={};r.attr("data-languagename")!=="undefined"&&(f.currentLanguage.Name=r.attr("data-languagename"));r.attr("data-languageid")!=="undefined"&&(f.currentLanguage.Id=r.attr("data-languageid"));f.currentLanguage.LogicalName="adx_websitelanguage";f.currentLanguage.__metadata={type:"Microsoft.Xrm.Sdk.EntityReference"};var e=r.attr("data-logicalname"),s=r.attr("data-id"),h=r.attr("data-rootwebpageid");return e&&s&&(f.current={LogicalName:e,Id:s}),e&&h&&(f.rootWebpage={LogicalName:e,Id:h}),f.valid=!!f.uri,o=[],n.each(f.fields,function(){var t=this,u,e;t.type==="select"&&(u=n("a.xrm-entity-"+t.optionEntityName+"-ref",r).attr("href"),u||(t.expansion?o.push(t):f.valid=!1),t.uri=t.filter?XRM.util.updateQueryStringParameter(u,"filter",t.filter):u,t.uriTemplate=n("a.xrm-entity-edit"+t.optionEntityName+"-ref",r).attr("href"),t.create&&t.create.relationship&&(t.create.uriTemplate=n("a.xrm-uri-template.xrm-entity-"+t.create.relationship+"-ref",r).attr("href"),t.create.entityContainer=r));i.configureDateTimeField(t,r);t.type==="file"&&(e=n("a.xrm-uri-template.xrm-entity-"+t.name+"-ref",r).attr("href"),e||(f.valid=!1),t.fileUploadUriTemplate=e);t.type==="html"&&(t.cmsTemplateUrl=r.data("cmstemplate-url"),t.fileBrowserServiceUri=r.data("filebrowser-url")||n("a.xrm-filebrowser-ref",r).attr("href"),t.fileBrowserDialogUri=r.data("filebrowser-dialog-url")||n("a.xrm-filebrowser-dialog-ref",r).attr("href"));t.type==="iframe"&&(t.src=t.src||(r.closest("[data-xrm-base]").attr("data-xrm-base")||"")+t.xrmsrc);t.type==="parent"&&(t.uri=r.attr("data-parentoptions"),t.uriTemplate=r.attr("data-parentoptions-uritemplate"))}),n.each(o,function(){var t=this;f.fields.splice(n.inArray(t,f.fields),1)}),f}});XRM.onActivate(function(){var i=XRM.namespace("editable.Entity.handlers"),r=XRM.editable.Entity,t=r.Handler,u=XRM.jQuery,n;XRM.localizations["adx_blog.shortname"]=window.ResourceManager.ADX_Blog_ShortName;XRM.localizations["adx_blog.update.tooltip"]=window.ResourceManager.ADX_Blog_Update_Tooltip;XRM.localizations["entity.create.adx_blog.label"]=window.ResourceManager.Entity_Create_ADX_Blog_Label;XRM.localizations["entity.create.adx_blog.tooltip"]=window.ResourceManager.Entity_Create_ADX_Blog_Tooltip;XRM.localizations["entity.delete.adx_blog.tooltip"]=window.ResourceManager.Entity_Delete_ADX_Blog_Tooltip;n=i.adx_blog=function(t,i){var r=u("a.xrm-entity-ref",t).attr("href");t.hasClass("xrm-entity-current")&&r&&(n.renderUpdateButton(t,i,r),n.renderDeleteButton(t,i,r),n.renderCreateButton(t,i,r))};n.formPrototype={uri:null,urlServiceUri:null,urlServiceUriTemplate:null,title:null,entityName:"adx_blog",fields:[{name:"adx_name",label:window.ResourceManager.Name_Label,type:"text",required:!0},{name:"adx_partialurl",label:window.ResourceManager.Partial_URL_Label,type:"text",required:!0,slugify:"adx_name"},{name:"adx_summary",label:window.ResourceManager.Summary_Label,type:"html",tinymceSettings:{height:240}},{name:"adx_bloghomepagetemplateid",label:window.ResourceManager.Home_Template_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_pagetemplate",optionText:"adx_name",optionValue:"adx_pagetemplateid",optionDescription:"adx_description",sortby:"adx_name",filter:"adx_blog"},{name:"adx_blogpostpagetemplateid",label:window.ResourceManager.Post_Template_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_pagetemplate",optionText:"adx_name",optionValue:"adx_pagetemplateid",optionDescription:"adx_description",sortby:"adx_name",filter:"adx_blogpost"},{name:"adx_blogarchivepagetemplateid",label:window.ResourceManager.Archive_Template_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_pagetemplate",optionText:"adx_name",optionValue:"adx_pagetemplateid",optionDescription:"adx_description",sortby:"adx_name",filter:"adx_webpage"},{name:"adx_commentpolicy",label:window.ResourceManager.Comment_Policy_Label,type:"picklist",required:!0},{name:"adx_parentpageid",label:window.ResourceManager.Parent_Page_Label,type:"parent",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_webpage",disableAtRoot:!0,defaultToCurrent:!0,defaultToRoot:!0}],layout:{cssClass:"xrm-dialog-expanded",full:!0,columns:[{cssClass:"xrm-dialog-column-main",fields:["adx_name","adx_summary"]},{cssClass:"xrm-dialog-column-side",fields:["adx_parentpageid","adx_partialurl","adx_bloghomepagetemplateid","adx_blogpostpagetemplateid","adx_blogarchivepagetemplateid","adx_commentpolicy"]}]}};n.getForm=function(i,r){return t.getForm(n.formPrototype,i,r)};n.createOptions=[{entityName:"adx_blogpost",relationship:"adx_blog_blogpost",label:"entity.create.adx_blogpost.label",title:"entity.create.adx_blogpost.tooltip",redirect:!0}];n.renderCreateButton=function(i,r,u){t.renderCreateButton(n.createOptions,i,r,u,XRM.localize("entity.create.label"),"")};n.renderDeleteButton=function(n,i,r){t.renderDeleteButton(n,i,r,XRM.localize("adx_blog.shortname"))};n.renderUpdateButton=function(n,i,r){t.renderUpdateButton("adx_blog",n,i,r,XRM.localize("entity.update.label"),XRM.localize("adx_blog.update.tooltip"))}});XRM.onActivate(function(){var i=XRM.namespace("editable.Entity.handlers"),r=XRM.editable.Entity,t=r.Handler,u=XRM.jQuery,n;XRM.localizations["adx_blogpost.shortname"]=window.ResourceManager.ADX_BlogPost_ShortName;XRM.localizations["adx_blogpost.update.tooltip"]=window.ResourceManager.ADX_BlogPost_Update_Tooltip;XRM.localizations["entity.create.adx_blogpost.label"]=window.ResourceManager.Entity_Create_ADX_BlogPost_Label;XRM.localizations["entity.create.adx_blogpost.tooltip"]=window.ResourceManager.Entity_Create_ADX_BlogPost_Tooltip;XRM.localizations["entity.delete.adx_blogpost.tooltip"]=window.ResourceManager.Entity_Delete_ADX_BlogPost_Tooltip;n=i.adx_blogpost=function(t,i){var r=u("a.xrm-entity-ref",t).attr("href");t.hasClass("xrm-entity-current")&&r&&(n.renderUpdateButton(t,i,r),n.renderDeleteButton(t,i,r),n.renderCreateButton(t,i,r))};n.formPrototype={uri:null,urlServiceUri:null,urlServiceUriTemplate:null,title:null,entityName:"adx_blogpost",fields:[{name:"adx_name",label:window.ResourceManager.Title_Label,type:"text",required:!0},{name:"adx_date",label:window.ResourceManager.Date_Label,type:"datetime",excludeEmptyData:!0,required:!0,defaultToNow:!0},{name:"adx_partialurl",label:window.ResourceManager.Partial_URL_Label,type:"text"},{name:"adx_summary",label:window.ResourceManager.Summary_Excerpt_Label,type:"html",ckeditorSettings:{height:80}},{name:"adx_copy",label:window.ResourceManager.Copy_Label,type:"html",ckeditorSettings:{height:240}},{name:"adx_commentpolicy",label:window.ResourceManager.Comment_Policy_Label,type:"picklist",required:!0},{name:"adx_published",label:window.ResourceManager.Published_Label,type:"checkbox",checkedByDefault:!0},{name:"adx_enableratings",label:window.ResourceManager.Enable_Ratings_Label,type:"checkbox",checkedByDefault:!1},{name:"__extensions.tags",label:window.ResourceManager.Tags_Label,type:"tags"}],layout:{cssClass:"xrm-dialog-expanded",full:!0,columns:[{cssClass:"xrm-dialog-column-main",fields:["adx_name","adx_summary","adx_copy"]},{cssClass:"xrm-dialog-column-side",fields:["adx_date","adx_partialurl","__extensions.tags","adx_commentpolicy","adx_published","adx_enableratings"]}]}};n.getForm=function(i,r){return t.getForm(n.formPrototype,i,r)};n.createOptions=[{entityName:"adx_webfile",relationship:"adx_blogpost_webfile",label:"entity.create.adx_webfile.label",title:"entity.create.adx_webfile.tooltip",redirect:!1}];n.renderCreateButton=function(i,r,u){t.renderCreateButton(n.createOptions,i,r,u,XRM.localize("entity.create.label"),"")};n.renderDeleteButton=function(n,i,r){t.renderDeleteButton(n,i,r,XRM.localize("adx_blogpost.shortname"))};n.renderUpdateButton=function(n,i,r){t.renderUpdateButton("adx_blogpost",n,i,r,XRM.localize("entity.update.label"),XRM.localize("adx_blogpost.update.tooltip"))}});XRM.onActivate(function(){var r=XRM.namespace("editable.Entity.handlers"),i=XRM.editable.Entity,u=i.Handler,t=XRM.jQuery,n;XRM.localizations["adx_pagecomment.shortname"]=window.ResourceManager.ADX_PageComment_ShortName;XRM.localizations["adx_pagecomment.update.tooltip"]=window.ResourceManager.ADX_PageComment_Update_Tooltip;XRM.localizations["entity.delete.adx_pagecomment.tooltip"]=window.ResourceManager.Entity_Delete_ADX_PageComment_Tooltip;n=r.feedback=function(r){var u=t("a.xrm-entity-ref",r).attr("href"),f=t("a.xrm-entity-delete-ref",r).attr("href");u&&t(".xrm-edit",r).click(function(){var t=n.getForm(r,{title:XRM.localize("adx_pagecomment.update.tooltip"),uri:u});t&&t.valid&&i.showEditDialog(t)});f&&t(".xrm-delete",r).click(function(){i.showDeletionDialog(r,f,XRM.localize("adx_pagecomment.shortname"))})};n.formPrototype={uri:null,urlServiceUri:null,urlServiceUriTemplate:null,title:null,entityName:"feedback",reload:!0,fields:[{name:"title",label:window.ResourceManager.Name_Label,type:"text",required:!0},{name:"comments",label:window.ResourceManager.Content_Label,type:"html",ckeditorSettings:{height:240}},{name:"adx_approved",label:window.ResourceManager.Approved_Label,type:"checkbox"}],layout:{cssClass:"xrm-dialog-wide",columns:[{cssClass:"xrm-dialog-column-main",fields:["title","comments","adx_approved"]}]}};n.getForm=function(t,i){return u.getForm(n.formPrototype,t,i)}});XRM.onActivate(function(){var i=XRM.namespace("editable.Entity.handlers"),r=XRM.editable.Entity,t=r.Handler,u=XRM.jQuery,n;XRM.localizations["adx_communityforum.shortname"]=window.ResourceManager.ADX_CommunityForum_ShortName;XRM.localizations["adx_communityforum.update.tooltip"]=window.ResourceManager.ADX_CommunityForum_Update_Tooltip;XRM.localizations["entity.create.adx_communityforum.label"]=window.ResourceManager.Entity_Create_ADX_CommunityForum_Label;XRM.localizations["entity.create.adx_communityforum.tooltip"]=window.ResourceManager.Entity_Create_ADX_CommunityForum_Tooltip;XRM.localizations["entity.delete.adx_communityforum.tooltip"]=window.ResourceManager.Entity_Delete_ADX_CommunityForum_Tooltip;n=i.adx_communityforum=function(t,i){var r=u("a.xrm-entity-ref",t).attr("href");t.hasClass("xrm-entity-current")&&r&&(n.renderUpdateButton(t,i,r),n.renderDeleteButton(t,i,r),n.renderCreateButton(t,i,r))};n.formPrototype={uri:null,urlServiceUri:null,urlServiceUriTemplate:null,title:null,entityName:"adx_communityforum",fields:[{name:"adx_name",label:window.ResourceManager.Name_Label,type:"text",required:!0},{name:"adx_parentpageid",label:window.ResourceManager.Parent_Page_Label,type:"parent",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_webpage",disableAtRoot:!0,defaultToCurrent:!0,defaultToRoot:!0},{name:"adx_partialurl",label:window.ResourceManager.Partial_URL_Label,type:"text",required:!0,slugify:"adx_name"},{name:"adx_description",label:window.ResourceManager.Description_Label,type:"text"},{name:"adx_forumpagetemplateid",label:window.ResourceManager.Forum_Template_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_pagetemplate",optionText:"adx_name",optionValue:"adx_pagetemplateid",optionDescription:"adx_description",sortby:"adx_name",filter:"adx_communityforum"},{name:"adx_threadpagetemplateid",label:window.ResourceManager.Thread_Template_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_pagetemplate",optionText:"adx_name",optionValue:"adx_pagetemplateid",optionDescription:"adx_description",sortby:"adx_name",filter:"adx_communityforumthread"},{name:"adx_publishingstateid",label:window.ResourceManager.Publishing_State_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_publishingstate",optionText:"adx_name",optionValue:"adx_publishingstateid"},{name:"adx_hiddenfromsitemap",label:window.ResourceManager.Hidden_From_Sitemap_Label,type:"checkbox"}]};n.getForm=function(i,r){return t.getForm(n.formPrototype,i,r)};n.createOptions=[];n.renderCreateButton=function(i,r,u){t.renderCreateButton(n.createOptions,i,r,u,XRM.localize("entity.create.label"),"")};n.renderDeleteButton=function(n,i,r){t.renderDeleteButton(n,i,r,XRM.localize("adx_communityforum.shortname"))};n.renderUpdateButton=function(n,i,r){t.renderUpdateButton("adx_communityforum",n,i,r,XRM.localize("entity.update.label"),XRM.localize("adx_communityforum.update.tooltip"))}});XRM.onActivate(function(){var r=XRM.namespace("editable.Entity.handlers"),i=XRM.editable.Entity,u=i.Handler,n=XRM.jQuery,t;XRM.localizations["adx_communityforumpost.shortname"]=window.ResourceManager.ADX_CommunityForumPost_ShortName;XRM.localizations["adx_communityforumpost.update.tooltip"]=window.ResourceManager.ADX_CommunityForumPost_Update_Tooltip;XRM.localizations["entity.delete.adx_communityforumpost.tooltip"]=window.ResourceManager.Entity_Delete_ADX_CommunityForumPost_Tooltip;t=r.adx_communityforumpost=function(r){var u=n("a.xrm-entity-ref",r).attr("href"),f=n("a.xrm-entity-delete-ref",r).attr("href");u&&n(".xrm-edit",r).click(function(){var n=t.getForm(r,{title:XRM.localize("adx_communityforumpost.update.tooltip"),uri:u});n&&n.valid&&i.showEditDialog(n)});f&&n(".xrm-delete",r).click(function(){var t=n(this);i.showDeletionDialog(r,f,XRM.localize("adx_communityforumpost.shortname"),t.data("warning"))})};t.formPrototype={uri:null,urlServiceUri:null,urlServiceUriTemplate:null,title:null,entityName:"adx_communityforumpost",reload:!0,fields:[{name:"adx_name",label:window.ResourceManager.Name_Label,type:"text",required:!0},{name:"adx_content",label:window.ResourceManager.Content_Label,type:"html",ckeditorSettings:{height:240}},{name:"adx_isanswer",label:window.ResourceManager.Answer_Label,type:"checkbox"}],layout:{cssClass:"xrm-dialog-wide",columns:[{cssClass:"xrm-dialog-column-main",fields:["adx_name","adx_content","adx_isanswer"]}]}};t.getForm=function(n,i){return u.getForm(t.formPrototype,n,i)}});XRM.onActivate(function(){var i=XRM.namespace("editable.Entity.handlers"),r=XRM.editable.Entity,t=r.Handler,u=XRM.jQuery,n;XRM.localizations["adx_communityforumthread.shortname"]=window.ResourceManager.ADX_Community_Forum_Thread_ShortName;XRM.localizations["adx_communityforumthread.update.tooltip"]=window.ResourceManager.ADX_CommunityForumThread_Update_Tooltip;XRM.localizations["entity.delete.adx_communityforumthread.tooltip"]=window.ResourceManager.Entity_Delete_ADX_CommunityForumThread_Tooltip;n=i.adx_communityforumthread=function(t,i){var r=u("a.xrm-entity-ref",t).attr("href");t.hasClass("xrm-entity-current")&&r&&(n.renderUpdateButton(t,i,r),n.renderDeleteButton(t,i,r))};n.formPrototype={uri:null,urlServiceUri:null,urlServiceUriTemplate:null,title:null,entityName:"adx_communityforumthread",fields:[{name:"adx_name",label:window.ResourceManager.Name_Label,type:"text",required:!0},{name:"adx_typeid",label:window.ResourceManager.Thread_Type_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_forumthreadtype",optionText:"adx_name",optionValue:"adx_forumthreadtypeid"},{name:"__extensions.tags",label:window.ResourceManager.Tags_Label,type:"tags"},{name:"adx_sticky",label:window.ResourceManager.Sticky_Label,type:"checkbox"},{name:"adx_isanswered",label:window.ResourceManager.Answered_Label,type:"checkbox"},{name:"adx_locked",label:window.ResourceManager.Locked_Label,type:"checkbox"}]};n.getForm=function(i,r){return t.getForm(n.formPrototype,i,r)};n.createOptions=[];n.renderDeleteButton=function(n,i,r){t.renderDeleteButton(n,i,r,XRM.localize("adx_communityforumthread.shortname"))};n.renderUpdateButton=function(n,i,r){t.renderUpdateButton("adx_communityforumthread",n,i,r,XRM.localize("entity.update.label"),XRM.localize("adx_communityforumthread.update.tooltip"))}});XRM.onActivate(function(){var i=XRM.namespace("editable.Entity.handlers"),r=XRM.editable.Entity,t=r.Handler,u=XRM.jQuery,n;XRM.localizations["adx_event.shortname"]=window.ResourceManager.ADX_Event_ShortName;XRM.localizations["adx_event.update.tooltip"]=window.ResourceManager.ADX_Event_Update_Tooltip;XRM.localizations["entity.create.adx_event.label"]=window.ResourceManager.Entity_Create_ADX_Event_Label;XRM.localizations["entity.create.adx_event.tooltip"]=window.ResourceManager.Entity_Create_ADX_Event_Tooltip;XRM.localizations["entity.delete.adx_event.tooltip"]=window.ResourceManager.Entity_Delete_ADX_Event_Tooltip;n=i.adx_event=function(t,i){var r=u("a.xrm-entity-ref",t).attr("href");t.hasClass("xrm-entity-current")&&r&&(n.renderUpdateButton(t,i,r),n.renderDeleteButton(t,i,r),n.renderCreateButton(t,i,r))};n.formPrototype={uri:null,urlServiceUri:null,urlServiceUriTemplate:null,title:null,entityName:"adx_event",fields:[{name:"adx_name",label:window.ResourceManager.Name_Label,type:"text",required:!0},{name:"adx_partialurl",label:window.ResourceManager.Partial_URL_Label,type:"text",required:!0,slugify:"adx_name"},{name:"adx_pagetemplateid",label:window.ResourceManager.Page_Template_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_pagetemplate",optionText:"adx_name",optionValue:"adx_pagetemplateid",optionDescription:"adx_description",sortby:"adx_name",filter:"adx_event"},{name:"adx_publishingstateid",label:window.ResourceManager.Publishing_State_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_publishingstate",optionText:"adx_name",optionValue:"adx_publishingstateid"},{name:"adx_releasedate",label:window.ResourceManager.Release_Date_Label,type:"datetime",excludeEmptyData:!0},{name:"adx_expirationdate",label:window.ResourceManager.Expiration_Date_Label,type:"datetime",excludeEmptyData:!0},{name:"adx_hiddenfromsitemap",label:window.ResourceManager.Hidden_From_Sitemap_Label,type:"checkbox"},{name:"adx_requiresregistration",label:window.ResourceManager.Requires_Registration_Label,type:"checkbox"},{name:"adx_description",label:window.ResourceManager.Description_Label,type:"html",ckeditorSettings:{height:80}},{name:"adx_locationname",label:window.ResourceManager.Location_Name_Label,type:"text"},{name:"adx_summary",label:window.ResourceManager.Summary_Label,type:"html",ckeditorSettings:{height:80}},{name:"adx_content",label:window.ResourceManager.Registration_Content_Label,type:"html",ckeditorSettings:{height:80}},{name:"adx_parentpageid",label:window.ResourceManager.Parent_Page_Label,type:"parent",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_webpage",disableAtRoot:!0,defaultToCurrent:!0,defaultToRoot:!0}],layout:{cssClass:"xrm-dialog-expanded",full:!0,columns:[{cssClass:"xrm-dialog-column-main",fields:["adx_name","adx_description","adx_summary","adx_content"]},{cssClass:"xrm-dialog-column-side",fields:["adx_parentpageid","adx_partialurl","adx_pagetemplateid","adx_publishingstateid","adx_releasedate","adx_expirationdate","adx_locationname","adx_hiddenfromsitemap","adx_requiresregistration"]}]}};n.getForm=function(i,r){return t.getForm(n.formPrototype,i,r)};n.createOptions=[{entityName:"adx_eventschedule",relationship:"adx_event_eventschedule",label:"entity.create.adx_eventschedule.label",title:"entity.create.adx_eventschedule.tooltip",redirect:!1}];n.renderCreateButton=function(i,r,u){t.renderCreateButton(n.createOptions,i,r,u,XRM.localize("entity.create.label"),"")};n.renderDeleteButton=function(n,i,r){t.renderDeleteButton(n,i,r,XRM.localize("adx_event.shortname"))};n.renderUpdateButton=function(n,i,r){t.renderUpdateButton("adx_event",n,i,r,XRM.localize("entity.update.label"),XRM.localize("adx_event.update.tooltip"))}});XRM.onActivate(function(){var t=XRM.namespace("editable.Entity.handlers"),i=XRM.editable.Entity,r=i.Handler,u=XRM.jQuery,n;XRM.localizations["entity.create.adx_eventschedule.label"]=window.ResourceManager.Entity_Create_ADX_EventSchedule_Label;XRM.localizations["entity.create.adx_eventschedule.tooltip"]=window.ResourceManager.Entity_Create_ADX_EventSchedule_Tooltip;XRM.localizations["adx_eventschedule.recurrence"]=window.ResourceManager.ADX_EventSchedule_Recurrence;XRM.localizations["adx_eventschedule.acceptabledays"]=window.ResourceManager.ADX_EventSchedule_AcceptableDays;XRM.localizations["adx_eventschedule.shortname"]=window.ResourceManager.ADX_EventSchedule_ShortName;XRM.localizations["adx_eventschedule.update.tooltip"]=window.ResourceManager.ADX_EventSchedule_Update_Tooltip;XRM.localizations["entity.delete.adx_eventschedule.tooltip"]=window.ResourceManager.Entity_Delete_ADX_EventSchedule_Tooltip;n=t.adx_eventschedule=function(){};n.formPrototype={uri:null,urlServiceUri:null,urlServiceUriTemplate:null,title:null,entityName:"adx_eventschedule",reload:!0,fields:[{name:"adx_name",label:window.ResourceManager.Name_Label,type:"text",required:!0},{name:"adx_starttime",label:window.ResourceManager.Start_Time_Label,type:"datetime",required:!0},{name:"adx_endtime",label:window.ResourceManager.End_Time_Label,type:"datetime",required:!0},{name:"adx_publishingstateid",label:window.ResourceManager.Publishing_State_Label,type:"select",required:!0,excludeEmptyData:!0,uri:null,optionEntityName:"adx_publishingstate",optionText:"adx_name",optionValue:"adx_publishingstateid"},{name:"adx_alldayevent",label:window.ResourceManager.All_Day_Event_Label,type:"checkbox"},{name:"adx_recurrence",label:window.ResourceManager.Recurrence_Label,type:"picklist",required:!0},{name:"adx_week",label:window.ResourceManager.Week_Label,type:"picklist"},{name:"adx_recurrenceenddate",label:window.ResourceManager.Recurrence_End_Time_Label,type:"datetime",excludeEmptyData:!0},{name:"adx_maxrecurrences",label:window.ResourceManager.Max_Recurrences_Label,type:"integer"},{name:"adx_interval",label:window.ResourceManager.Interval_Label,type:"integer"},{name:"acceptabledays",type:"instructions"},{name:"adx_sunday",label:window.ResourceManager.Sunday_Label,type:"checkbox",checkedByDefault:!0},{name:"adx_monday",label:window.ResourceManager.Monday_Label,type:"checkbox",checkedByDefault:!0},{name:"adx_tuesday",label:window.ResourceManager.Tuesday_Label,type:"checkbox",checkedByDefault:!0},{name:"adx_wednesday",label:window.ResourceManager.Wednesday_Label,type:"checkbox",checkedByDefault:!0},{name:"adx_thursday",label:window.ResourceManager.Thursday_Label,type:"checkbox",checkedByDefault:!0},{name:"adx_friday",label:window.ResourceManager.Friday_Label,type:"checkbox",checkedByDefault:!0},{name:"adx_saturday",label:window.ResourceManager.Saturday_Label,type:"checkbox",checkedByDefault:!0}],layout:{cssClass:"xrm-dialog-3column",columns:[{cssClass:"xrm-dialog-column1",fields:["adx_name","adx_starttime","adx_endtime","adx_publishingstateid","adx_alldayevent"]},{cssClass:"xrm-dialog-column2",fields:["adx_recurrence","adx_week","adx_recurrenceenddate","adx_maxrecurrences","adx_interval"]},{cssClass:"xrm-dialog-column3",fields:["acceptabledays","adx_sunday","adx_monday","adx_tuesday","adx_wednesday","adx_thursday","adx_friday","adx_saturday"]}]}};n.getForm=function(t,i){return r.getForm(n.formPrototype,t,i)}});XRM.onActivate(function(){var t=XRM.namespace("editable.Entity.handlers"),i=XRM.editable.Entity,r=i.Handler,u=XRM.jQuery,n;XRM.localizations["adx_shortcut.shortname"]=window.ResourceManager.ADX_Shortcut_ShortName;XRM.localizations["adx_shortcut.update.tooltip"]=window.ResourceManager.ADX_Shortcut_Update_Tooltip;XRM.localizations["adx_shortcut.targetinstructions"]=window.ResourceManager.ADX_Shortcut_Target_Instructions;XRM.localizations["entity.create.adx_shortcut.label"]=window.ResourceManager.Entity_Create_ADX_Shortcut_Label;XRM.localizations["entity.create.adx_shortcut.tooltip"]=window.ResourceManager.Entity_Create_ADX_Shortcut_Tooltip;XRM.localizations["entity.delete.adx_shortcut.tooltip"]=window.ResourceManager.Entity_Delete_ADX_Shortcut_Tooltip;n=t.adx_shortcut=function(){};n.formPrototype={uri:null,urlServiceUri:null,urlServiceUriTemplate:null,title:null,entityName:"adx_shortcut",reload:!0,fields:[{name:"adx_name",label:window.ResourceManager.Name_Label,type:"text",required:!0},{name:"adx_title",label:window.ResourceManager.Title_Label,type:"text"},{name:"adx_description",label:window.ResourceManager.Description_Label,type:"html",ckeditorSettings:{height:240}},{name:"targetinstructions",type:"instructions"},{name:"adx_externalurl",label:window.ResourceManager.Target_URL_Label,type:"text"},{name:"adx_webpageid",label:window.ResourceManager.Target_Web_Page_Label,type:"select",excludeEmptyData:!0,uri:null,optionEntityName:"adx_webpage",optionText:"adx_name",optionValue:"adx_webpageid",sortby:"adx_name"},{name:"adx_webfileid",label:window.ResourceManager.Target_Web_File_Label,type:"select",excludeEmptyData:!0,uri:null,optionEntityName:"adx_webfile",optionText:"adx_name",optionValue:"adx_webfileid",sortby:"adx_name"},{name:"adx_eventid",label:window.ResourceManager.Target_Event_Label,type:"select",excludeEmptyData:!0,uri:null,optionEntityName:"adx_event",optionText:"adx_name",optionValue:"adx_eventid",sortby:"adx_name",expansion:!0},{name:"adx_forumid",label:window.ResourceManager.Target_Forum_Label,type:"select",excludeEmptyData:!0,uri:null,optionEntityName:"adx_communityforum",optionText:"adx_name",optionValue:"adx_communityforumid",sortby:"adx_name",expansion:!0},{name:"adx_disabletargetvalidation",label:window.ResourceManager.Disable_Target_Validation_Label,type:"checkbox"},{name:"adx_parentpage_webpageid",label:window.ResourceManager.Parent_Page_Label,type:"parent",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_webpage",disableAtRoot:!0,defaultToCurrent:!0,defaultToRoot:!0}],layout:{cssClass:"xrm-dialog-expanded",full:!0,columns:[{cssClass:"xrm-dialog-column-main",fields:["adx_name","adx_title","adx_description"]},{cssClass:"xrm-dialog-column-side",fields:["adx_parentpage_webpageid","targetinstructions","adx_externalurl","adx_webpageid","adx_webfileid","adx_eventid","adx_forumid","adx_disabletargetvalidation"]}]}};n.getForm=function(t,i){return r.getForm(n.formPrototype,t,i)}});XRM.onActivate(function(){var t=XRM.namespace("editable.Entity.handlers"),n;XRM.localizations["entity.delete.adx_webfile.tooltip"]=window.ResourceManager.Entity_Delete_ADX_Webfile_Tooltip;n=t.adx_webfile;n||XRM.log("XRM.editable.Entity.handlers.adx_webfile not found, unable to extend.","warn");n.formPrototype={uri:null,urlServiceUri:null,urlServiceUriTemplate:null,title:null,entityName:"adx_webfile",fields:[{name:"adx_name",label:window.ResourceManager.Name_Label,type:"text",required:!0},{name:"adx_partialurl",label:window.ResourceManager.Partial_URL_Label,type:"text",required:!0,slugify:"adx_name"},{name:"adx_webfile-attachment",label:window.ResourceManager.Upload_File_Label,labelOnUpdate:window.ResourceManager.Update_Upload_File_Label,type:"file",requiredOnUpdate:!1,fileUploadUriTemplate:null,copyFilenameTo:"adx_name",copyFilenameSlugTo:"adx_partialurl"},{name:"adx_publishingstateid",label:window.ResourceManager.Publishing_State_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_publishingstate",optionText:"adx_name",optionValue:"adx_publishingstateid"},{name:"adx_displaydate",label:window.ResourceManager.Display_Date_Label,type:"datetime",excludeEmptyData:!0},{name:"adx_releasedate",label:window.ResourceManager.Release_Date_Label,type:"datetime",excludeEmptyData:!0},{name:"adx_expirationdate",label:window.ResourceManager.Expiration_Date_Label,type:"datetime",excludeEmptyData:!0},{name:"adx_hiddenfromsitemap",label:window.ResourceManager.Hidden_From_Sitemap_Label,type:"checkbox"},{name:"adx_summary",label:window.ResourceManager.Summary_Label,type:"html",ckeditorSettings:{height:240}},{name:"adx_enabletracking",label:window.ResourceManager.Enable_Tracking_Label,type:"checkbox",checkedByDefault:!1},{name:"adx_cloudblobaddress",label:window.ResourceManager.Cloud_Blob_Address_Label,type:"text"},{name:"adx_contentdisposition",label:window.ResourceManager.Content_Disposition_Label,type:"picklist"},{name:"adx_parentpageid",label:window.ResourceManager.Parent_Page_Label,type:"parent",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_webpage",disableAtRoot:!0,defaultToCurrent:!0,defaultToRoot:!0},{name:"adx_excludefromsearch",label:window.ResourceManager.Exclude_From_Search_Label,type:"checkbox",checkedByDefault:!0}],layout:{cssClass:"xrm-dialog-expanded",full:!0,columns:[{cssClass:"xrm-dialog-column-main",fields:["adx_name","adx_webfile-attachment","adx_summary","adx_cloudblobaddress"]},{cssClass:"xrm-dialog-column-side",fields:["adx_parentpageid","adx_partialurl","adx_publishingstateid","adx_displaydate","adx_releasedate","adx_expirationdate","adx_contentdisposition","adx_hiddenfromsitemap","adx_enabletracking","adx_excludefromsearch"]}]}}});XRM.onActivate(function(){var f=XRM.namespace("editable.Entity.handlers"),i=XRM.editable.Entity,e=i.Handler,n=XRM.jQuery,o=XRM.yuiSkinClass,r=YAHOO.lang.JSON,u,t;XRM.localizations["entity.create.adx_weblinkset.tooltip"]=window.ResourceManager.Entity_Create_ADX_Weblinkset_Tooltip;XRM.localizations["adx_weblink.displaypagechildlinks.tooltip"]=window.ResourceManager.ADX_Weblink_DisplayPage_Childlinks_Tooltip;u=n.isFunction(n.fn.sortable);u||XRM.log("XRM weblinks sorting disabled. Include jQuery UI with Sortable interaction to enable.","warn","XRM.editable.Entity.handlers.adx_weblinkset");t=f.adx_weblinkset=function(i,r){var f=n("a.xrm-entity-ref",i),o=f.attr("href"),u,e;if(!o)return XRM.log("Unable to get weblink set service URI. Web links will not be editable.","warn","editable.Entity.handlers.adx_weblinkset");if(u=n("a.xrm-entity-adx_weblinkset_weblink-ref",i).attr("href"),e=n("a.xrm-entity-adx_weblinkset_weblink-update-ref",i).attr("href"),!u)return XRM.log("Unable to get child weblinks service URI. Web links will not be editable.","warn","editable.Entity.handlers.adx_weblinkset");t.addClassIfEmpty(i);i.editable(u,{loadSuccess:function(n){t.renderEditDialog(i,r,u,e,f.attr("title"),n)}})};t.addClassIfEmpty=function(n){n.children("ul, .weblinks").children("li, .weblink").length==0&&n.addClass("xrm-entity-value-empty")};t.setformPrototype={uri:null,urlServiceUri:null,urlServiceUriTemplate:null,title:null,entityName:"adx_weblinkset",fields:[{name:"adx_name",label:window.ResourceManager.Name_Label,type:"text",required:!0}]};t.getForm=function(n,i){return e.getForm(t.setformPrototype,n,i)};t.formPrototype={title:null,entityName:"adx_weblink",fields:[{name:"adx_name",label:window.ResourceManager.Name_Label,type:"text",required:!0},{name:"adx_pageid",label:window.ResourceManager.Page_Label,type:"select",excludeEmptyData:!1,uri:null,optionEntityName:"adx_webpage",optionText:"adx_name",optionValue:"adx_webpageid",sortby:"adx_name"},{name:"adx_externalurl",label:window.ResourceManager.External_URL_Label,type:"text"},{name:"adx_description",label:window.ResourceManager.Description_Label,type:"html",ckeditorSettings:{height:240}},{name:"adx_publishingstateid",label:window.ResourceManager.Publishing_State_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_publishingstate",optionText:"adx_name",optionValue:"adx_publishingstateid",sortby:"adx_name"},{name:"adx_imageurl",label:window.ResourceManager.Image_URL_Label,type:"text"},{name:"adx_imageheight",label:window.ResourceManager.Image_Height_Label,type:"integer"},{name:"adx_imagewidth",label:window.ResourceManager.Image_Width_Label,type:"integer"},{name:"adx_imagealttext",label:window.ResourceManager.Image_Alternate_Text_Label,type:"text"},{name:"adx_robotsfollowlink",label:window.ResourceManager.Robots_Follow_Link_Label,type:"checkbox",value:!0},{name:"adx_openinnewwindow",label:window.ResourceManager.Open_In_New_Window_Label,type:"checkbox"},{name:"adx_disablepagevalidation",label:window.ResourceManager.Disable_Page_Validation_Label,type:"checkbox"},{name:"adx_displayimageonly",label:window.ResourceManager.Display_Image_Only_Label,type:"checkbox"},{name:"adx_displaypagechildlinks",label:window.ResourceManager.Display_Page_Child_Links_Label,type:"checkbox"}],layout:{cssClass:"xrm-dialog-expanded",full:!0,columns:[{cssClass:"xrm-dialog-column-main",fields:["adx_name","adx_pageid","adx_externalurl","adx_description"]},{cssClass:"xrm-dialog-column-side",fields:["adx_publishingstateid","adx_imageurl","adx_imageheight","adx_imagewidth","adx_imagealttext","adx_displayimageonly","adx_robotsfollowlink","adx_openinnewwindow","adx_disablepagevalidation","adx_displaypagechildlinks"]}]}};t.getWeblinkForm=function(r,u,f){u=u||{};var e=n.extend(!0,{},t.formPrototype);return e.title=r,e.valid=!0,n.each(e.fields,function(n,i){var f=t.getWeblinkPropertyName(i.name),r;f&&(r=u[f],typeof r!="undefined")&&(i.value=r)}),n.each(e.fields,function(){var t=this,i;t.label=XRM.localize(e.entityName+"."+t.name)||t.label||t.name;t.type==="select"&&(i=n("a.xrm-entity-"+t.optionEntityName+"-ref",f).attr("href"),i||(e.valid=!1),t.uri=i);this.type==="file"&&(i=n("a.xrm-uri-template.xrm-entity-"+t.name+"-ref",f).attr("href"),i||(e.valid=!1),t.fileUploadUriTemplate=i)}),n.each(e.fields,function(){var t=this;i.configureDateTimeField(t,f);t.type==="html"&&(t.cmsTemplateUrl=f.data("cmstemplate-url"),t.fileBrowserServiceUri=f.data("filebrowser-url")||n("a.xrm-filebrowser-ref",f).attr("href"),t.fileBrowserDialogUri=f.data("filebrowser-dialog-url")||n("a.xrm-filebrowser-dialog-ref",f).attr("href"));t.type==="iframe"&&(t.src=t.src||(f.closest("[data-xrm-base]").attr("data-xrm-base")||"")+t.xrmsrc)}),e};t.getWeblinkPropertyName=function(n){return i.getPropertyName("adx_weblink",n)};t.renderEditDialog=function(r,f,e,s,h,c){function b(n){n.cancel();w.remove()}var w=n("<div />").addClass(o).appendTo(document.body),nt=n("<div />").addClass("xrm-editable-panel xrm-editable-dialog xrm-editable-dialog-weblinkset").appendTo(w),a=n.isArray(c.d)?c.d:[],l=new YAHOO.widget.Dialog(nt.get(0),{visible:!1,constraintoviewport:!0,zindex:XRM.zindex,xy:YAHOO.util.Dom.getXY(r.get(0)),buttons:[{text:XRM.localize("editable.save.label"),handler:function(){var i=this,r=XRM.ui.showProgressPanelAtXY(XRM.localize("editable.saving"),YAHOO.util.Dom.getXY(i.id)),u=n(".xrm-editable-weblinks",i.body);t.saveWebLinks(a,u,s,function(t,u){r();u.length<1?b(i):XRM.ui.showDataServiceError(n.map(u,function(n){return n.xhr}));document.location=document.location})},isDefault:!0},{text:XRM.localize("editable.cancel.label"),handler:function(){b(this)}}]}),y,k,d,g,p;l.setHeader(XRM.localize("editable.label.prefix")+(h||""));l.setBody('<ol class="xrm-editable-weblinks xrm-editable-weblinks-sortable"><\/ol>');y=t.getWeblinkPropertyName("adx_displayorder");a.sort(function(n,t){var i=n[y],r=t[y];return i<r?-1:i==r?0:1});var v=n(".xrm-editable-weblinks",l.body),tt=t.getWeblinkPropertyName("adx_parentweblinkid"),it=n.grep(a,function(n){return!n[tt]});n.each(it,function(n,i){t.addWebLinkItem(l,v,i,r,a)});k=t.getWeblinkForm("",{},r);k.valid&&(d=function(){var n=1;return function(){return n++}}(),g=n("<a />").attr("title",XRM.localize("entity.create.adx_weblink.tooltip")).addClass("xrm-add").insertAfter(v).append("<span />"),g.click(function(){var u=t.getWeblinkForm(XRM.localize("entity.create.adx_weblink.tooltip"),{},r);i.showEntityDialog(u,{save:function(i,u,f){t.addWebLinkItem(l,v,u,r).addClass("created").attr("data-created-id",d()).hide().show("slow");n.isFunction(f.success)&&f.success();l.focus()},cancel:function(){l.focus()}})}));p=parseInt(r.attr("data-weblinks-maxdepth"))||1;u&&v.sortable({connectWith:".xrm-editable-weblinks-sortable",handle:".xrm-drag-handle",opacity:.8,placeholder:"xrm-drag-placeholder",start:function(){n(".xrm-editable-weblink:not(.xrm-displaypagechildlinks) .xrm-editable-child-weblinks:empty",l.body).each(function(){var t=n(this),i=t.parentsUntil(".xrm-editable-weblinks",".xrm-editable-child-weblinks").length+1;(p<1||i<p)&&t.addClass("xrm-drag-target")})},stop:function(){n(".xrm-editable-child-weblinks",l.body).removeClass("xrm-drag-target")}});l.render();l.show();XRM.ui.registerOverlay(l);l.focus()};t.addWebLinkItem=function(f,e,o,s,h){var c=n("<li />").addClass("xrm-editable-weblink").appendTo(e),l=n("<div />").addClass("xrm-editable-weblink-inner").appendTo(c),v=t.getWeblinkPropertyName("adx_displaypagechildlinks"),a=n("<input />").attr("type","hidden").addClass("xrm-editable-weblink-data").appendTo(c),y,k,p,w,b;u?n("<a />").attr("title",XRM.localize("editable.sortable.tooltip")).addClass("xrm-drag-handle").appendTo(l):n("<span />").addClass("xrm-drag-disabled").appendTo(c);n("<a />").attr("title",XRM.localize("entity.delete.adx_weblink.tooltip")).addClass("xrm-delete").appendTo(l).click(function(){c.addClass("deleted").hide("slow");c.find(".xrm-editable-weblink").addClass("deleted")});y=n("<span />").addClass("name").text(o[t.getWeblinkPropertyName("adx_name")]);k=t.getWeblinkForm(XRM.localize("adx_weblink.update.tooltip"),{},s);k.valid&&n("<a />").attr("title",XRM.localize("adx_weblink.update.tooltip")).addClass("xrm-edit").appendTo(l).click(function(){var e=o,u;try{u=a.val();u&&(e=r.parse(u))}catch(h){}i.showEntityDialog(t.getWeblinkForm(XRM.localize("adx_weblink.update.tooltip"),e,s),{save:function(i,u,e){a.hasClass("create")||a.addClass("update");v&&u[v]?(c.addClass("xrm-displaypagechildlinks"),l.find(".xrm-displaypagechildlinks-icon").length<1&&n("<span />").attr("title",XRM.localize("adx_weblink.displaypagechildlinks.tooltip")).addClass("xrm-displaypagechildlinks-icon").appendTo(l)):(c.removeClass("xrm-displaypagechildlinks"),l.find(".xrm-displaypagechildlinks-icon").remove());var o=t.getWeblinkPropertyName("adx_name");o&&u[o]&&y.text(u[o]);a.val(r.stringify(u));n.isFunction(e.success)&&e.success();f.focus()},cancel:function(){f.focus()}})});y.appendTo(l);v&&o[v]&&(c.addClass("xrm-displaypagechildlinks"),n("<span />").attr("title",XRM.localize("adx_weblink.displaypagechildlinks.tooltip")).addClass("xrm-displaypagechildlinks-icon").appendTo(l));o.__metadata?(n("<a />").attr("href",o.__metadata.uri).addClass("xrm-entity-ref").appendTo(c).hide(),p=n("a.xrm-uri-template.xrm-entity-adx_weblink-delete-ref",s).attr("href"),p&&(w=XRM.util.expandUriTemplate(p,o),w&&n("<a />").attr("href",w).addClass("xrm-entity-delete-ref").appendTo(c).hide())):a.addClass("create").val(r.stringify(o));var g=t.getWeblinkPropertyName("adx_parentweblinkid"),nt=n.grep(h||[],function(n){var t=n[g];return t&&t.Id===o.Id}),d=n("<ul />").addClass("xrm-editable-child-weblinks").addClass("xrm-editable-weblinks-sortable").appendTo(c);return n.each(nt,function(n,i){t.addWebLinkItem(f,d,i,s,h)}),b=parseInt(s.attr("data-weblinks-maxdepth"))||1,u&&d.sortable({connectWith:".xrm-editable-weblinks-sortable",handle:".xrm-drag-handle",opacity:.8,placeholder:"xrm-drag-placeholder",start:function(){n(".xrm-editable-weblink:not(.xrm-displaypagechildlinks) .xrm-editable-child-weblinks:empty",f.body).each(function(){var t=n(this),i=t.parentsUntil(".xrm-editable-weblinks",".xrm-editable-child-weblinks").length+1;(b<1||i<b)&&t.addClass("xrm-drag-target")})},stop:function(){n(".xrm-editable-child-weblinks",f.body).removeClass("xrm-drag-target")}}),c};t.saveWebLinks=function(i,r,u,f){function l(){n.isFunction(f)&&f(s,h)}function p(){s.length+h.length>=o&&l()}function a(t,i){n.isArray(e[t])||(e[t]=[]);e[t].push(i)}var c={},v=t.getWeblinkPropertyName("adx_displayorder"),y=t.getWeblinkPropertyName("adx_parentweblinkid"),e=[],s=[],h=[],o=0;if(n.each(i,function(n,t){c[t.__metadata.uri]=t}),n(".xrm-editable-weblink.deleted",r).each(function(t,i){var r=n(i).children(".xrm-entity-delete-ref").attr("href");r&&a(0,{uri:r,method:null})}),n.each(n.map(n(".xrm-editable-weblink:not(.deleted)",r).get(),function(i,r){return t.getWebLinkOperation(n(i),r,c,u,y,v)}),function(n,t){a(t.depth,t)}),n.each(e,function(t,i){n.isArray(i)&&(o=o+i.length)}),o<1){l();return}t.saveWebLinksAtDepth(0,e,s,h,p)};t.getWebLinkOperation=function(n,i,r,u,f,e){var s=r[n.children(".xrm-entity-ref").attr("href")],h=i+1,c=n.children(".xrm-editable-weblink-data").val(),o=n.parent().parent(".xrm-editable-weblink").eq(0),l=o?r[o.children(".xrm-entity-ref").attr("href")]:null,a=n.parentsUntil(".xrm-editable-weblinks",".xrm-editable-child-weblinks").length;return s?t.getWebLinkUpdateOperation(s,c,a,o,l,f,h,e):t.getWebLinkCreateOperation(n,u,c,a,o,l,f,h,e)};t.getWebLinkCreateOperation=function(n,t,i,u,f,e,o,s,h){var c;try{c=r.parse(i)}catch(l){return null}return c?(c[h]=s,e&&(c[o]={LogicalName:e.LogicalName,Id:e.Id}),{uri:t,method:null,data:c,depth:u,creationId:n.attr("data-created-id"),parentPropertyName:o,parentCreationId:f?f.attr("data-created-id"):null}):null};t.getWebLinkUpdateOperation=function(n,t,i,u,f,e,o,s){var h={},l=n[e],c=!1;if(t)try{h=r.parse(t);c=!!h}catch(a){}return(n[s]!=o&&(h[s]=o,c=!0),f&&(!l||l.Id!==f.Id)?(h[e]={LogicalName:f.LogicalName,Id:f.Id},c=!0):u&&u.hasClass("created")?c=!0:!n[e]||f||u&&u.hasClass("created")||(h[e]=null,c=!0),!c)?null:{uri:n.__metadata.uri,method:"MERGE",data:h,depth:i,parentPropertyName:e,parentCreationId:u?u.attr("data-created-id"):null}};t.saveWebLinksAtDepth=function(i,r,u,f,e){function c(){e();t.saveWebLinksAtDepth(i+1,r,u,f,e)}function l(){h++;h>=s&&c()}if(i>=r.length){e();return}var o=r[i],s=n.isArray(o)?o.length:0,h=0;if(s<1){c();return}n.each(o,function(t,i){var e,r;i.parentCreationId&&i.parentPropertyName&&(e=n.grep(u,function(n){return n.operation.creationId===i.parentCreationId}),e.length>0&&(r=e[0],r&&r.data&&r.data.d&&(i.data[i.parentPropertyName]={LogicalName:r.data.d.LogicalName,Id:r.data.d.Id})));XRM.data.postJSON(i.uri,i.data,{httpMethodOverride:i.method,success:function(n){u.push({operation:i,data:n});l()},error:function(n){f.push({operation:i,xhr:n});l()}})})}});XRM.onActivate(function(){function u(n,t){if(!(this.value&&this.value.Id)){$(t).parent().remove();return}var r=$(".xrm-entity-current a.xrm-entity-ref").attr("href"),u=function(n){return n.splice(n.length-2,2),n.join("/")}(r.split("/")),i=function(n){return u.split("/").concat(n).join("/")};$.when($.getJSON(i(["adx_websitelanguage"])),$.getJSON(i(["adx_webpage",this.value.Id,"__related","adx_webpage_webpage_rootwebpageid.Referenced"])),$.getJSON(i(["adx_publishingstate"]))).done(function(t,i,r){for(var f=t[0].d,a=i[0].d,e=r[0].d,v=function(n){for(var r,t=null,i=0;i<e.length;i++)r=e[i],r.Id===n&&(t=r.adx_isvisible);return t===!0?"state-published":t===!1?"state-draft":"state-not-created"},o=$("<div/>",{"class":"xrm-language-grid"}).append($("<table/>",{"class":"language-grid"}).append()),s=$("<tbody/>"),u=0;u<f.length;u++){var h=f[u],c=_.find(a,function(n){return n.adx_webpagelanguageid&&n.adx_webpagelanguageid.Id===h.Id}),l=c&&c.adx_publishingstateid||{},y=$("<tr/>").append([$("<td/>").append($("<div/>",{text:h.Name})),$("<td/>",{text:l.Name||window.ResourceManager.Adx_Webpage_Not_Yet_Created,"class":v(l.Id)})]);s.append(y)}s.appendTo($(o).find("table"));o.appendTo(n)})}var r=XRM.namespace("editable.Entity.handlers"),n,i;XRM.localizations["entity.delete.adx_webpage.tooltip"]=window.ResourceManager.Entity_Delete_ADX_Webpage_Tooltip;n=r.adx_webpage;i=$("html").data("lang");n||XRM.log("XRM.editable.Entity.handlers.adx_webpage not found, unable to extend.","warn");var f={id:"general",label:window.ResourceManager.General_Label,icon:"adx-icon adx-icon-file-text-o",columns:[{cssClass:"xrm-dialog-simple-fields-one-third",fields:["adx_name","adx_parentpageid","adx_partialurl","adx_pagetemplateid","adx_webform","adx_entityform","adx_entitylist","adx_rootwebpageid"]}]},e={id:"general",label:window.ResourceManager.General_Label,icon:"adx-icon adx-icon-file-text-o",columns:[{cssClass:"xrm-dialog-column-main",fields:["adx_name","adx_title","adx_copy","adx_summary"]},{cssClass:"xrm-dialog-column-side",fields:["adx_parentpageid","adx_partialurl","adx_pagetemplateid","adx_publishingstateid","adx_webform","adx_entityform","adx_entitylist"]}]},o={id:"content",label:window.ResourceManager.Content_Language_Label,icon:"adx-icon adx-icon-file-text-o",columns:[{cssClass:"xrm-dialog-simple-fields-one-third",fields:["adx_webpagelanguageid","adx_publishingstateid","adx_title","adx_copy","adx_summary"]}]},s={id:"options",label:window.ResourceManager.Options_Label,icon:"adx-icon adx-icon-cog",columns:[{cssClass:"xrm-dialog-column-main",fields:["adx_meta_description","adx_customjavascript","adx_customcss"]},{cssClass:"xrm-dialog-column-side",fields:["adx_displaydate","adx_subjectid","adx_feedbackpolicy","adx_enablerating","adx_hiddenfromsitemap","adx_excludefromsearch"]}]},h={id:"publishing",label:window.ResourceManager.Publishing_Label,icon:"adx-icon adx-icon-share-alt",columns:[{cssClass:"xrm-dialog-column-main",fields:["adx_editorialcomments"]},{cssClass:"xrm-dialog-column-side",fields:["adx_releasedate","adx_expirationdate"]}]},t=[];i?(t.push(f),t.push(o)):t.push(e);t.push(s);t.push(h);n.formPrototype={uri:null,urlServiceUri:null,urlServiceUriTemplate:null,title:null,entityName:"adx_webpage",fields:[{name:"adx_name",label:window.ResourceManager.Name_Label,type:"text",required:!0,maxlength:100},{name:"adx_title",label:window.ResourceManager.Title_Label,type:"text",maxlength:512},{name:"adx_partialurl",label:window.ResourceManager.Partial_URL_Label,type:"text",required:!0,slugify:"adx_name"},{name:"adx_pagetemplateid",label:window.ResourceManager.Page_Template_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_pagetemplate",optionText:"adx_name",optionValue:"adx_pagetemplateid",optionDescription:"adx_description",sortby:"adx_name",filter:"adx_webpage"},{name:"adx_publishingstateid",label:window.ResourceManager.Publishing_State_Label,type:"select",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_publishingstate",optionText:"adx_name",optionValue:"adx_publishingstateid"},{name:"adx_displaydate",label:window.ResourceManager.Display_Date_Label,type:"datetime",excludeEmptyData:!0},{name:"adx_releasedate",label:window.ResourceManager.Release_Date_Label,type:"datetime",excludeEmptyData:!0},{name:"adx_expirationdate",label:window.ResourceManager.Expiration_Date_Label,type:"datetime",excludeEmptyData:!0},{name:"adx_hiddenfromsitemap",label:window.ResourceManager.Hidden_From_Sitemap_Label,type:"checkbox"},{name:"adx_copy",label:window.ResourceManager.Copy_Label,type:"html",ckeditorSettings:{height:640}},{name:"adx_summary",label:window.ResourceManager.Summary_Label,type:"html",ckeditorSettings:{height:280}},{name:"adx_subjectid",label:window.ResourceManager.Subject_Label,type:"select",excludeEmptyData:!1,required:!1,uri:null,optionEntityName:"subject",optionText:"title",optionValue:"subjectid"},{name:"adx_feedbackpolicy",label:window.ResourceManager.Comment_Policy_Label,type:"picklist",required:!0},{name:"adx_enablerating",label:window.ResourceManager.Enable_Ratings_Label,type:"checkbox",checkedByDefault:!1},{name:"adx_entityform",label:window.ResourceManager.Entity_Form_Label,type:"select",excludeEmptyData:!1,required:!1,uri:null,optionEntityName:"adx_entityform",optionText:"adx_name",optionValue:"adx_entityformid",expansion:!0},{name:"adx_entitylist",label:window.ResourceManager.Entity_List_Label,type:"select",excludeEmptyData:!1,required:!1,uri:null,optionEntityName:"adx_entitylist",optionText:"adx_name",optionValue:"adx_entitylistid",expansion:!0},{name:"adx_webform",label:window.ResourceManager.Web_Form_Label,type:"select",excludeEmptyData:!1,required:!1,uri:null,optionEntityName:"adx_webform",optionText:"adx_name",optionValue:"adx_webformid",expansion:!0},{name:"adx_editorialcomments",label:window.ResourceManager.Editorial_Comments_Label,type:"textarea",height:200,maxlength:2e3},{name:"adx_excludefromsearch",label:window.ResourceManager.Exclude_From_Search_Label,type:"checkbox",checkedByDefault:!1},{name:"adx_enabletracking",label:window.ResourceManager.Enable_Tracking_Label,type:"checkbox",checkedByDefault:!1},{name:"adx_meta_description",label:window.ResourceManager.Description_Label,type:"text",maxlength:255},{name:"adx_customjavascript",label:window.ResourceManager.Custom_JavaScript_Label,type:"iframe",xrmsrc:"js/editable/source_js.html",height:240},{name:"adx_customcss",label:window.ResourceManager.Custom_CSS_Label,type:"iframe",xrmsrc:"js/editable/source_css.html",height:240},{name:"adx_webpagelanguageid",label:window.ResourceManager.Language_Label,type:"text",excludeEmptyData:!1,disabled:!0,formatter:function(n){return n.Name},defaultToCurrentLang:!0},{name:"adx_rootwebpageid",label:window.ResourceManager.Language_Label,type:"customrender",excludeEmptyData:!1,disabled:!0,render:u},{name:"adx_parentpageid",label:window.ResourceManager.Parent_Page_Label,type:"parent",excludeEmptyData:!0,required:!0,uri:null,optionEntityName:"adx_webpage",disableAtRoot:!0,defaultToCurrent:!0,defaultToRoot:!0}],layout:{cssClass:"xrm-dialog-expanded",full:!0,tabs:t}};n.createOptions.push({entityName:"adx_event",relationship:"adx_webpage_event",label:"entity.create.adx_event.label",title:"entity.create.adx_event.tooltip",redirect:!0});n.createOptions.push({entityName:"adx_communityforum",relationship:"adx_webpage_communityforum",label:"entity.create.adx_communityforum.label",title:"entity.create.adx_communityforum.tooltip",redirect:!0});n.createOptions.push({entityName:"adx_shortcut",relationship:"adx_parentwebpage_shortcut",label:"entity.create.adx_shortcut.label",title:"entity.create.adx_shortcut.tooltip",redirect:!1})});XRM.onActivate(function(){var o=XRM.namespace("editable.Entity.handlers"),i=XRM.editable.Entity,n=XRM.jQuery,f=XRM.yuiSkinClass,e=YAHOO.lang.JSON,r="xrm-editable-sitemapchild-hidden",u,t;XRM.localizations["editable.deletemultiple.tooltip.prefix"]=window.ResourceManager.Editable_DeleteMultiple_Tooltip_Prefix;XRM.localizations["editable.deletemultiple.tooltip.suffix.singular"]=window.ResourceManager.Editable_DeleteMultiple_Tooltip_Suffix_Singular;XRM.localizations["editable.deletemultiple.tooltip.suffix.plural"]=window.ResourceManager.Editable_DeleteMultiple_Tooltip_Suffix_Plural;XRM.localizations["confirm.deletemultiple.entity"]=window.ResourceManager.Confirm_DeleteMultiple_Entity;XRM.localizations["sitemapchildren.update.tooltip"]=window.ResourceManager.SitemapChildren_Update_Tooltip;XRM.localizations["sitemapchildren.hiddenfromsitemap.tooltip"]=window.ResourceManager.SitemapChildren_HiddenFrom_Sitemap_Tooltip;u=n.isFunction(n.fn.sortable);u||XRM.log("XRM weblinks sorting disabled. Include jQuery UI with Sortable interaction to enable.","warn","XRM.editable.Entity.handlers.sitemapchildren");t=o.sitemapchildren=function(i,r){var f=n("a.xrm-entity-ref-sitemapchildren",i),u=f.attr("href"),e=f.attr("title"),o,s;if(!u){XRM.log("Unable to get site map children service URI. Child view will not be editable.","warn","editable.Entity.handlers.sitemapchildren");return}i.hasClass("xrm-entity-current")?(o=n("<div />").addClass("xrm-editable-toolbar-module").appendTo(r.body).get(0),s=new YAHOO.widget.Button({container:o,label:window.ResourceManager.Cms_Sitemapchildren_Update_Label,title:XRM.localize("sitemapchildren.update.tooltip"),onclick:{fn:function(){var n=XRM.ui.showProgressPanel(XRM.localize("editable.loading"),{close:!1,draggable:!1,zindex:XRM.zindex,visible:!1,context:[r.element,"tr","tl",[],[-10,0]],constraintoviewport:!0});XRM.data.getJSON(u,{success:function(f){n();t.renderEditDialog(i,u,e,f,!0,r)},error:function(t){n();XRM.ui.showDataServiceError(t,XRM.localize("error.dataservice.loading"))}})}}})):i.editable(u,{loadSuccess:function(n){t.renderEditDialog(i,u,e,n,!1)}})};t.renderEditDialog=function(i,r,e,o,s,h){function p(n){n.cancel();v.remove()}var v=n("<div />").addClass(f).appendTo(document.body),w=n("<div />").addClass("xrm-editable-panel xrm-editable-dialog xrm-editable-dialog-sitemapchildren").appendTo(v),y=n.isArray(o.d)?o.d:[],l=n("<ol />").addClass("xrm-editable-sitemapchildren"),a={visible:!1,zindex:XRM.zindex,constraintoviewport:!0,buttons:[{text:XRM.localize("editable.save.label"),handler:function(){var n=this,i=XRM.ui.showProgressPanelAtXY(XRM.localize("editable.saving"),YAHOO.util.Dom.getXY(n.id));t.saveChildren(y,l,{save:function(){i();p(n);document.location=document.location},cancel:function(){i()}})},isDefault:!0},{text:XRM.localize("editable.cancel.label"),handler:function(){p(this)}}]},c;s&&h?a.context=[h.element,"tr","tl",[],[-10,0]]:a.xy=YAHOO.util.Dom.getXY(i.get(0));c=new YAHOO.widget.Dialog(w.get(0),a);c.setHeader(XRM.localize("sitemapchildren.header.label")+(e?" ("+e+")":""));c.setBody(" ");l.appendTo(c.body);n.each(y,function(n,r){t.addChildItem(c,l,r,i)});u&&l.sortable({handle:".xrm-drag-handle",opacity:.8});c.render();c._aButtons!=null&&c._aButtons.length==2&&(n("#"+c._aButtons[0]._button.id).attr("title",XRM.localize("editable.save.label")),n("#"+c._aButtons[1]._button.id).attr("title",XRM.localize("editable.cancel.label")));c.show();n(".container-close").attr("role","button").attr("title",window.ResourceManager.Close_DefaultText);XRM.ui.registerOverlay(c);c.focus()};t.addChildItem=function(f,o,s,h){var c=n("<li />").addClass("xrm-editable-sitemapchild").appendTo(o),v;s.HiddenFromSiteMap&&c.addClass(r);var y=n("<input />").attr("type","hidden").addClass("xrm-editable-sitemapchild-data").appendTo(c),l=t.getChildEntityUri(s,h),a=s.HasPermission&&!!l,b=a&&s.DisplayOrderPropertyName,p=t.getChildEntityDeleteUri(s,h),w=s.HasPermission&&!!p;u&&b?n("<a />").attr("title",XRM.localize("editable.sortable.tooltip")).addClass("xrm-drag-handle").appendTo(c):n("<span />").addClass("xrm-drag-disabled").appendTo(c);w&&n("<a />").attr("title",XRM.localize("entity.delete."+s.LogicalName+".tooltip")||"Delete this item").addClass("xrm-delete").appendTo(c).click(function(){c.addClass("deleted").hide("slow")});a&&(v=t.getChildEntityForm(s.LogicalName,l,s,h,!1),v&&v.valid&&n("<a />").attr("title",XRM.localize(s.LogicalName+".update.tooltip")||"Edit this item").addClass("xrm-edit").appendTo(c).click(function(){var n=null,r,u;try{r=y.val();r&&(n=e.parse(r))}catch(o){n=null}u=n?i.showEntityDialog:i.showEditDialog;u(t.getChildEntityForm(s.LogicalName,l,n||{},h,!1,s),{save:function(n,i,r){t.saveChild(c,y,n,i,r);f.focus()},cancel:function(){f.focus()}})}));n("<a />").attr("title",XRM.localize("entity.hiddenfromsitemap."+s.LogicalName+".tooltip")||XRM.localize("sitemapchildren.hiddenfromsitemap.tooltip")||"").addClass("xrm-hidden").appendTo(c);n("<span />").addClass("name").text(s.Title||"").appendTo(c);a&&n("<a />").attr("href",l).addClass("xrm-entity-ref").appendTo(c).hide();w&&n("<a />").attr("href",p).addClass("xrm-entity-delete-ref").appendTo(c).hide();n("<span />").addClass("xrm-entity-id").text(s.Id||"").appendTo(c).hide()};t.saveChild=function(t,u,f,o,s){var l,h,c;u.val(e.stringify(o));l=n.map(f.fields,function(n){return n.type==="file"&&(n.fileUploadUri||n.fileUploadUriTemplate)?new i.Form.fieldTypes.file(f.entityName,n):null});n.each(l,function(i,r){var f=n("#"+r.id),u;f.val()&&(u=r.id+"-update",n("#"+u).remove(),f.hide().appendTo(t).addClass("xrm-file-update").attr("id",u).data("xrm-field",r))});h=null;n.each(["adx_title","adx_name"],function(n,t){var r=i.getPropertyName(f.entityName,t);return r?(h=o[r],h?!1:void 0):!0});c=i.getPropertyName(f.entityName,"adx_hiddenfromsitemap");c&&(o[c]===!1&&t.hasClass(r)&&t.removeClass(r),o[c]!==!0||t.hasClass(r)||t.addClass(r));h&&n(".name",t).text(h);n.isFunction(s.success)&&s.success()};t.getChildEntityForm=function(t,r,u,f,e){var h,s,c,a,v,l;return(u=u||{},h=o[t],!(h&&h.formPrototype))?null:(s=n.extend(!0,{},h.formPrototype),s.uri=r,s.title=XRM.localize(t+".update.tooltip"),s.valid=!!s.uri,arguments.length>4&&(c=arguments[5],n.isEmptyObject(c)||n.type(s.current)!=="undefined"||(a=c.LogicalName,v=c.Id,s.current={LogicalName:a,Id:v},!1||n.isEmptyObject(u)||(s.current.optionsEdit=!0))),n.each(s.fields,function(n,t){var f=i.getPropertyName(s.entityName,t.name),r;f&&(r=u[f],typeof r!="undefined")&&(t.value=r)}),l=[],n.each(s.fields,function(t,r){var u,o;r.label=!e&&r.labelOnUpdate?XRM.localize(s.entityName+"."+r.name+".onupdate")||r.labelOnUpdate||r.label||r.name:XRM.localize(s.entityName+"."+r.name)||r.label||r.name;r.type==="select"&&(u=n("a.xrm-entity-"+r.optionEntityName+"-ref",f).attr("href"),u||(r.expansion?l.push(r):s.valid=!1),r.uri=r.filter?XRM.util.updateQueryStringParameter(u,"filter",r.filter):u,r.uriTemplate=n("a.xrm-entity-edit"+r.optionEntityName+"-ref",f).attr("href"),r.create&&r.create.relationship&&(r.create.uriTemplate=n("a.xrm-uri-template.xrm-entity-"+r.create.relationship+"-ref",f).attr("href"),r.create.entityContainer=f));i.configureDateTimeField(r,f);r.type==="file"&&(o=n("a.xrm-uri-template.xrm-entity-"+r.name+"-ref",f).attr("href"),o||(s.valid=!1),r.fileUploadUriTemplate=o);r.type==="html"&&(r.cmsTemplateUrl=f.data("cmstemplate-url"),r.fileBrowserServiceUri=f.data("filebrowser-url")||n("a.xrm-filebrowser-ref",f).attr("href"),r.fileBrowserDialogUri=f.data("filebrowser-dialog-url")||n("a.xrm-filebrowser-dialog-ref",f).attr("href"));r.type==="iframe"&&(r.src=r.src||(f.closest("[data-xrm-base]").attr("data-xrm-base")||"")+r.xrmsrc);r.type==="parent"&&(r.uri=f.attr("data-parentoptions"),r.uriTemplate=f.attr("data-parentoptions-uritemplate"));e||r.requiredOnUpdate!==!1||(r.required=!1)}),n.each(l,function(){var n=this;s.fields.splice(s.fields.indexOf(n),1)}),s)};t.getChildEntityUri=function(t,i){var r=n(".xrm-uri-template.xrm-entity-"+t.LogicalName+"-ref",i).attr("href");return r?XRM.util.expandUriTemplate(r,t):null};t.getChildEntityDeleteUri=function(t,i){var r=n(".xrm-uri-template.xrm-entity-"+t.LogicalName+"-delete-ref",i).attr("href");return r?XRM.util.expandUriTemplate(r,t):null};t.saveChildren=function(r,u,f){function c(){n.when.apply(n,n.map(o,function(n){return n()})).then(l)}var l=n.isFunction(f.save)?f.save:function(){},a=n.isFunction(f.cancel)?f.cancel:function(){},h={},s=[],o=[];if(n.each(r,function(n,t){t.Id&&(h[t.Id]=t)}),n(".xrm-editable-sitemapchild.deleted",u).each(function(t,i){var r=n(".xrm-entity-delete-ref",i).attr("href");r&&(s.push({name:n(".name",i).text()}),o.push(function(){var t=n.Deferred();return XRM.data.postJSON(r,null,{success:function(){t.resolve()},error:function(){t.resolve()}}),t.promise()}))}),n(".xrm-editable-sitemapchild:not(.deleted)",u).each(function(t,r){var c=n(".xrm-entity-ref",r).attr("href"),u;if(c&&(u=h[n(".xrm-entity-id",r).text()],u)){var l=t+1,f={},s=!1,a=n(".xrm-editable-sitemapchild-data",r).val();if(a)try{f=e.parse(a);s=!!f}catch(v){}u.DisplayOrderPropertyName&&u.DisplayOrder!=l&&(f[u.DisplayOrderPropertyName]=l,s=!0);s&&o.push(function(){var t=n.Deferred();return i.saveEditDialog({uri:c},f,{disableFileUploads:!0,disableProgress:!0,success:function(){t.resolve()},error:function(){t.resolve()}}),t.promise()});n(".xrm-file-update",r).each(function(){var i=n(this),t=i.data("xrm-field");t&&(i.attr("id",t.id),o.push(function(){var i=n.Deferred();return t.upload({d:u},function(){i.resolve()}),i.promise()}))})}}),s.length<1){c();return}t.showDeletionConfirmationDialog(s,c,function(){a()})};t.showDeletionConfirmationDialog=function(t,i,r){function o(t){t.cancel();e.remove();n(document.body).removeClass(f)}function c(){o(this);i(t)}function l(){o(this);r(t)}var e=n("<div />").addClass("xrm-editable-panel xrm-editable-dialog").appendTo(document.body),u=new YAHOO.widget.SimpleDialog(e.get(0),{fixedcenter:!0,visible:!1,draggable:!1,close:!1,modal:!0,icon:YAHOO.widget.SimpleDialog.ICON_WARN,constraintoviewport:!0,buttons:[{text:XRM.localize("confirm.yes"),handler:c,isDefault:!0},{text:XRM.localize("confirm.no"),handler:l}]}),s,h;u.setHeader(" ");u.setBody(" ");s=XRM.localize("editable.deletemultiple.tooltip.prefix")+t.length+XRM.localize("editable.deletemultiple.tooltip.suffix."+(t.length>1?"plural":"singular"));n("<span />").text(s).appendTo(u.header);n("<p />").text(XRM.localize("confirm.deletemultiple.entity")).appendTo(u.body);h=n("<ul />").addClass("xrm-editable-sitemapchildren-deletions").appendTo(u.body);n.each(t,function(t,i){n("<li />").text(i.name).appendTo(h)});n(document.body).addClass(f);u.render();u.show();XRM.ui.registerOverlay(u);u.focus()}});XRM.onActivate(function(){XRM.editable.Entity.getPropertyName=function(n,t){return t};XRM.util.formatDateForDataService=function(n){return"/Date("+n.getTime()+")/"}});(function(){typeof console!="undefined"&&console&&(XRM&&XRM.__consoleInfo&&(console.info=XRM.__consoleInfo),XRM&&XRM.__consoleLog&&(console.log=XRM.__consoleLog),XRM&&XRM.__consoleWarn&&(console.warn=XRM.__consoleWarn))})()